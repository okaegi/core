var ba=Object.defineProperty;var wa=(t,e,a)=>e in t?ba(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var l=(t,e,a)=>wa(t,typeof e!="symbol"?e+"":e,a);import{m as ka,r as Y,a as X,M as Sa,d as B,o as u,c as f,n as Z,b as k,e as de,f as ee,g,s as ye,h as je,i as xa,j as s,t as x,u as r,k as w,w as S,l as R,p as le,q as ce,v as Nt,x as Ut,y as Ma,z as A,F as K,A as ge,B as De,C as vt,D as Te,E as Ft,G as ut,H as nt,I as Ue,J as at,K as _t,L as $a,N as Ye,O as yt,P as Pa,Q as Ia,R as rt,S as We,T as Ca,U as Jt,V as pt,W as Ba}from"./vendor-B-lkTxtL.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function a(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=a(n);fetch(n.href,i)}})();function ot(t,e=1){let a;if(t>=1e3&&e<4){switch(e){case 0:a=Math.round(t/1e3);break;case 1:a=Math.round(t/100)/10;break;case 2:a=Math.round(t/10)/100;break;case 3:a=Math.round(t)/1e3;break;default:a=Math.round(t/100)/10;break}return(a==null?void 0:a.toLocaleString(void 0,{minimumFractionDigits:e}))+" kW"}else return Math.round(t).toLocaleString(void 0)+" W"}function Rt(t,e=1,a=!1){let o;if(t>1e6&&(a=!0,t=t/1e3),t>=1e3&&e<4){switch(e){case 0:o=Math.round(t/1e3);break;case 1:o=(Math.round(t/100)/10).toFixed(1);break;case 2:o=(Math.round(t/10)/100).toFixed(2);break;case 3:o=(Math.round(t)/1e3).toFixed(3);break;default:o=Math.round(t/100)/10;break}return o.toLocaleString(void 0,{minimumFractionDigits:e})+(a?" MWh":" kWh")}else return Math.round(t).toLocaleString(void 0)+(a?" kWh":" Wh")}function Oa(t){return t.toLocaleTimeString([],{hour:"numeric",minute:"2-digit"})}function Ta(t,e){return["Jan","Feb","MÃ¤rz","April","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"][t]+" "+e}const La=0,Ht={host:location.hostname,port:location.protocol=="https:"?443:80,endpoint:"/ws",protocol:location.protocol=="https:"?"wss":"ws",connectTimeout:4e3,reconnectPeriod:4e3,clean:!1,clientId:Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,6)},st={topic:"",qos:La};let me;const{host:Va,port:Aa,endpoint:Da,...Yt}=Ht,Ga=`${Yt.protocol}://${Va}:${Aa}${Da}`;try{me=ka.connect(Ga,Yt),me.on("connect",()=>{console.info("MQTT connection successful.")}),me.on("disconnect",()=>{console.info("MQTT disconnected")}),me.on("error",t=>{console.error("MQTT connection failed: ",t)})}catch(t){console.error("MQTT connect error: ",t)}async function Ea(t){await qt(),me?me.on("message",t):console.error("MqttRegister: MQTT client not available")}async function Ae(t){st.topic=t;const{topic:e,qos:a}=st;await qt(),me.subscribe(e,{qos:a},o=>{if(o){console.error("MQTT Subscription error: "+o);return}})}function ze(t){st.topic=t;const{topic:e}=st;me.unsubscribe(e,a=>{if(a){console.error("MQTT Unsubscribe from "+t+" failed: "+a);return}})}async function bt(t,e){let o=me.connected,n=0;for(;!o&&n<10;)console.warn("MQTT not connected. Waiting 0.1 seconds"),await Qt(100),o=me.connected,n+=1;if(n<10)try{me.publish(t,e,{qos:0},i=>{i&&console.warn("MQTT publish error: ",i),console.info("MQTT publish: Message sent: ["+t+"]("+e+")")})}catch(i){console.warn("MQTT publish: caught error: "+i)}else console.error("MQTT publish: Lost connection to MQTT server. Please reload the page")}function St(){return Ht.clientId}const Bt=20;async function qt(){let t=me.connected,e=0;for(;!t&&e<Bt;)console.warn("MQTT not connected. Waiting 0.1 seconds"),await Qt(100),t=me.connected,e+=1;return new Promise((a,o)=>{e<Bt?a(!0):o(!1)})}function Qt(t){return new Promise(e=>setTimeout(e,t))}class Wa{constructor(e){l(this,"id");l(this,"name","Ladepunkt");l(this,"icon","Ladepunkt");l(this,"type","");l(this,"ev",0);l(this,"template",0);l(this,"connectedPhases",0);l(this,"phase_1",0);l(this,"autoPhaseSwitchHw",!1);l(this,"controlPilotInterruptionHw",!1);l(this,"isEnabled",!0);l(this,"isPluggedIn",!1);l(this,"isCharging",!1);l(this,"_isLocked",!1);l(this,"_connectedVehicle",0);l(this,"chargeTemplate",0);l(this,"evTemplate",0);l(this,"_chargeMode","pv_charging");l(this,"_hasPriority",!1);l(this,"currentPlan","");l(this,"averageConsumption",0);l(this,"vehicleName","");l(this,"rangeCharged",0);l(this,"rangeUnit","");l(this,"counter",0);l(this,"dailyYield",0);l(this,"energyPv",0);l(this,"energyBat",0);l(this,"pvPercentage",0);l(this,"faultState",0);l(this,"faultStr","");l(this,"phasesInUse",0);l(this,"power",0);l(this,"chargedSincePlugged",0);l(this,"stateStr","");l(this,"current",0);l(this,"currents",[0,0,0]);l(this,"phasesToUse",0);l(this,"isSocConfigured",!0);l(this,"isSocManual",!1);l(this,"waitingForSoc",!1);l(this,"color","white");l(this,"_timedCharging",!1);l(this,"_instantChargeLimitMode","");l(this,"_instantTargetCurrent",0);l(this,"_instantTargetSoc",0);l(this,"_instantMaxEnergy",0);l(this,"_pvFeedInLimit",!1);l(this,"_pvMinCurrent",0);l(this,"_pvMaxSoc",0);l(this,"_pvMinSoc",0);l(this,"_pvMinSocCurrent",0);l(this,"_etActive",!1);l(this,"_etMaxPrice",20);this.id=e}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e,ae("cpLock",e,this.id)}updateIsLocked(e){this._isLocked=e}get connectedVehicle(){return this._connectedVehicle}set connectedVehicle(e){this._connectedVehicle=e,ae("cpVehicle",e,this.id)}updateConnectedVehicle(e){this._connectedVehicle=e}get soc(){return z[this.connectedVehicle]?z[this.connectedVehicle].soc:0}set soc(e){z[this.connectedVehicle]&&(z[this.connectedVehicle].soc=e)}get chargeMode(){return this._chargeMode}set chargeMode(e){this._chargeMode=e,ae("chargeMode",e,this.id)}updateChargeMode(e){this._chargeMode=e}get hasPriority(){return this._hasPriority}set hasPriority(e){this._hasPriority=e,ae("cpPriority",e,this.id)}updateCpPriority(e){this._hasPriority=e}get timedCharging(){return ue[this.chargeTemplate]?ue[this.chargeTemplate].time_charging.active:!1}set timedCharging(e){ue[this.chargeTemplate].time_charging.active=e,ae("cpTimedCharging",e,this.chargeTemplate)}get instantTargetCurrent(){return this._instantTargetCurrent}set instantTargetCurrent(e){this._instantTargetCurrent=e,ae("cpInstantTargetCurrent",e,this.id)}updateInstantTargetCurrent(e){this._instantTargetCurrent=e}get instantChargeLimitMode(){return this._instantChargeLimitMode}set instantChargeLimitMode(e){this._instantChargeLimitMode=e,ae("cpInstantChargeLimitMode",e,this.id)}updateInstantChargeLimitMode(e){this._instantChargeLimitMode=e}get instantTargetSoc(){return this._instantTargetSoc}set instantTargetSoc(e){this._instantTargetSoc=e,ae("cpInstantTargetSoc",e,this.id)}updateInstantTargetSoc(e){this._instantTargetSoc=e}get instantMaxEnergy(){return this._instantMaxEnergy}set instantMaxEnergy(e){this._instantMaxEnergy=e,ae("cpInstantMaxEnergy",e,this.id)}updateInstantMaxEnergy(e){this._instantMaxEnergy=e}get pvFeedInLimit(){return this._pvFeedInLimit}set pvFeedInLimit(e){this._pvFeedInLimit=e,ae("cpPvFeedInLimit",e,this.id)}updatePvFeedInLimit(e){this._pvFeedInLimit=e}get pvMinCurrent(){return this._pvMinCurrent}set pvMinCurrent(e){this._pvMinCurrent=e,ae("cpPvMinCurrent",e,this.id)}updatePvMinCurrent(e){this._pvMinCurrent=e}get pvMaxSoc(){return this._pvMaxSoc}set pvMaxSoc(e){this._pvMaxSoc=e,ae("cpPvMaxSoc",e,this.id)}updatePvMaxSoc(e){this._pvMaxSoc=e}get pvMinSoc(){return this._pvMinSoc}set pvMinSoc(e){this._pvMinSoc=e,ae("cpPvMinSoc",e,this.id)}updatePvMinSoc(e){this._pvMinSoc=e}get pvMinSocCurrent(){return this._pvMinSocCurrent}set pvMinSocCurrent(e){this._pvMinSocCurrent=e,ae("cpPvMinSocCurrent",e,this.id)}updatePvMinSocCurrent(e){this._pvMinSocCurrent=e}get realCurrent(){switch(this.phasesInUse){case 0:return 0;case 1:return this.currents[0];case 2:return(this.currents[0]+this.currents[1])/2;case 3:return(this.currents[0]+this.currents[1]+this.currents[2])/3;default:return 0}}get etActive(){return z[this.connectedVehicle]?z[this.connectedVehicle].etActive:!1}set etActive(e){z[this.connectedVehicle]&&(z[this.connectedVehicle].etActive=e)}get etMaxPrice(){return z[this.connectedVehicle].etMaxPrice??0}set etMaxPrice(e){console.log("Setting et max price needs to be implemented"),ae("cpEtMaxPrice",Math.round(e*10)/1e6,this.id)}toPowerItem(){return{name:this.name,power:this.power,energy:this.dailyYield,energyPv:this.energyPv,energyBat:this.energyBat,pvPercentage:this.pvPercentage,color:this.color,icon:this.icon}}}class za{constructor(e){l(this,"id");l(this,"name","");l(this,"_chargeTemplateId",0);l(this,"_evTemplateId",0);l(this,"tags",[]);l(this,"config",{});l(this,"soc",0);l(this,"range",0);l(this,"_etActive",!1);l(this,"_etMaxPrice",20);this.id=e}get chargeTemplateId(){return this._chargeTemplateId}set chargeTemplateId(e){this._chargeTemplateId=e,ae("vhChargeTemplateId",e,this.id)}updateChargeTemplateId(e){this._chargeTemplateId=e}get evTemplateId(){return this._evTemplateId}set evTemplateId(e){this._evTemplateId=e,ae("vhEvTemplateId",e,this.id)}updateEvTemplateId(e){this._evTemplateId=e}get etActive(){return ue[this.chargeTemplateId]?ue[this.chargeTemplateId].et.active:!1}set etActive(e){ue[this.chargeTemplateId]&&ae("priceCharging",e,this.chargeTemplateId)}get etMaxPrice(){if(ue[this.chargeTemplateId]&&ue[this.chargeTemplateId].et.active)return ue[this.chargeTemplateId].et.max_price*1e5}get chargepoint(){for(const e of Object.values(I))if(e.connectedVehicle==this.id)return e}}var _e=(t=>(t.instant_charging="instant_charging",t.pv_charging="pv_charging",t.scheduled_charging="scheduled_charging",t.standby="standby",t.stop="stop",t))(_e||{});const I=Y({}),z=Y({}),ue=Y({}),Fe=Y({}),Je=Y({}),wt=Y({});function ja(t){t in I||(I[t]=new Wa(t),I[t].color="var(--color-cp"+(Object.values(I).length-1)+")")}function Na(){Object.keys(I).forEach(t=>{delete I[parseInt(t)]})}const Ua={cpLock:"openWB/set/chargepoint/%/set/manual_lock",chargeMode:"openWB/set/vehicle/template/charge_template/%/chargemode/selected",cpPriority:"openWB/set/vehicle/template/charge_template/%/prio",cpTimedCharging:"openWB/set/vehicle/template/charge_template/%/time_charging/active",pvBatteryPriority:"openWB/set/general/chargemode_config/pv_charging/bat_prio",cpVehicle:"openWB/set/chargepoint/%/config/ev",cpInstantChargeLimitMode:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/selected",cpInstantTargetCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/current",cpInstantTargetSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/soc",cpInstantMaxEnergy:"openWB/set/vehicle/template/charge_template/%/chargemode/instant_charging/limit/amount",cpPvFeedInLimit:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/feed_in_limit",cpPvMinCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_current",cpPvMaxSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/max_soc",cpPvMinSoc:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc",cpPvMinSocCurrent:"openWB/set/vehicle/template/charge_template/%/chargemode/pv_charging/min_soc_current",cpEtMaxPrice:"openWB/set/vehicle/template/charge_template/%/et/max_price",vhChargeTemplateId:"openWB/set/vehicle/%/charge_template",vhEvTemplateId:"openWB/set/vehicle/%/ev_template",shSetManual:"openWB/set/LegacySmartHome/config/set/Devices/%/mode",shSwitchOn:"openWB/set/LegacySmartHome/config/set/Devices/%/device_manual_control",socUpdate:"openWB/set/vehicle/%/get/force_soc_update",setSoc:"openWB/set/vehicle/%/soc_module/calculated_soc_state/manual_soc",priceCharging:"openWB/set/vehicle/template/charge_template/%/et/active"};function ae(t,e,a=0){if(isNaN(a)){console.warn("Invalid index");return}let o=Ua[t];if(!o){console.warn("No topic for update type "+t);return}switch(t){case"chargeMode":case"cpPriority":case"cpScheduledCharging":case"cpInstantTargetCurrent":case"cpInstantChargeLimitMode":case"cpInstantTargetSoc":case"cpInstantMaxEnergy":case"cpPvFeedInLimit":case"cpPvMinCurrent":case"cpPvMaxSoc":case"cpPvMinSoc":case"cpEtMaxPrice":case"cpPvMinSocCurrent":o=o.replace("%",I[a].chargeTemplate.toString());break;default:o=o.replace("%",String(a))}switch(typeof e){case"number":bt(o,JSON.stringify(+e));break;default:bt(o,JSON.stringify(e))}}function xt(t){bt("openWB/set/command/"+St()+"/todo",JSON.stringify(t))}class Fa{constructor(){l(this,"batterySoc",0);l(this,"isBatteryConfigured",!0);l(this,"chargeMode","0");l(this,"_pvBatteryPriority",!1);l(this,"displayLiveGraph",!0);l(this,"isEtEnabled",!0);l(this,"etMaxPrice",0);l(this,"etCurrentPrice",0);l(this,"cpDailyExported",0);l(this,"evuId",0);l(this,"etProvider","");l(this,"ipAddress","");l(this,"systemTime","");l(this,"version","");l(this,"versionDetails","");l(this,"devBranch","")}get pvBatteryPriority(){return this._pvBatteryPriority}set pvBatteryPriority(e){this._pvBatteryPriority=e,ae("pvBatteryPriority",e)}updatePvBatteryPriority(e){this._pvBatteryPriority=e}}const ie=Y({evuIn:{name:"Netz",color:"var(--color-evu)",icon:"ïµ"},pv:{name:"PV",color:"var(--color-pv",icon:"ïº"},batOut:{name:"Bat >",color:"var(--color-battery)",icon:"ïï¡"},evuOut:{name:"Export",color:"var(--color-export)",icon:"ï¡ï½"},charging:{name:"Laden",color:"var(--color-charging)",icon:"ï§"},devices:{name:"GerÃ¤te",color:"var(--color-devices)",icon:"ï¦"},batIn:{name:"> Bat",color:"var(--color-battery)",icon:"ï¡ï"},house:{name:"Haus",color:"var(--color-house)",icon:"ï"},cp1:{name:"Ladepunkt",color:"var(--color-cp1)",icon:"Ladepunkt"},cp2:{name:"Ladepunkt",color:"var(--color-cp2)",icon:"Ladepunkt"},cp3:{name:"Ladepunkt",color:"var(--color-cp3)",icon:"Ladepunkt"},cp4:{name:"Ladepunkt",color:"var(--color-cp4)",icon:"Ladepunkt"},cp5:{name:"Ladepunkt",color:"var(--color-cp5)",icon:"Ladepunkt"},cp6:{name:"Ladepunkt",color:"var(--color-cp6)",icon:"Ladepunkt"},cp7:{name:"Ladepunkt",color:"var(--color-cp7)",icon:"Ladepunkt"},cp8:{name:"Ladepunkt",color:"var(--color-cp8)",icon:"Ladepunkt"},sh1:{name:"GerÃ¤t",color:"var(--color-sh1)",icon:"GerÃ¤t"},sh2:{name:"GerÃ¤t",color:"var(--color-sh2)",icon:"GerÃ¤t"},sh3:{name:"GerÃ¤t",color:"var(--color-sh3)",icon:"GerÃ¤t"},sh4:{name:"GerÃ¤t",color:"var(--color-sh4)",icon:"GerÃ¤t"},sh5:{name:"GerÃ¤t",color:"var(--color-sh5)",icon:"GerÃ¤t"},sh6:{name:"GerÃ¤t",color:"var(--color-sh6)",icon:"GerÃ¤t"},sh7:{name:"GerÃ¤t",color:"var(--color-sh7)",icon:"GerÃ¤t"},sh8:{name:"GerÃ¤t",color:"var(--color-sh8)",icon:"GerÃ¤t"},sh9:{name:"GerÃ¤t",color:"var(--color-sh9)",icon:"GerÃ¤t"}});class Zt{constructor(){l(this,"_items",{});this.addItem("evuIn"),this.addItem("pv"),this.addItem("batOut"),this.addItem("evuOut"),this.addItem("charging"),this.addItem("devices"),this.addItem("batIn"),this.addItem("house")}get items(){return this._items}keys(){return Object.keys(this._items)}values(){return Object.values(this._items)}addItem(e){this._items[e]=Ie(e)}setEnergy(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energy=a}setEnergyPv(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energyPv=a}setEnergyBat(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].energyBat=a}setPvPercentage(e,a){this.keys().includes(e)||this.addItem(e),this._items[e].pvPercentage=a}calculateHouseEnergy(){this._items.house.energy=this._items.evuIn.energy+this._items.pv.energy+this._items.batOut.energy-this._items.evuOut.energy-this._items.batIn.energy-this._items.charging.energy-this._items.devices.energy}}let P=new Zt;function Mt(){P=new Zt}const N=Y({evuIn:Ie("evuIn"),pv:Ie("pv"),batOut:Ie("batOut")}),C=Y({evuOut:Ie("evuOut"),charging:Ie("charging"),devices:Ie("devices"),batIn:Ie("batIn"),house:Ie("house")}),te=Y(new Fa);X("");const it=X(!1);function Ie(t){return{name:ie[t]?ie[t].name:"item",power:0,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:ie[t]?ie[t].color:"var(--color-charging)",icon:ie[t]?ie[t].icon:""}}const fe=Y({active:!1,locked:!0,usePin:!1,code:"",timeout:60,localCpOnly:!1});function Xt(){fe.usePin&&fe.locked?new Sa("#numberpad").toggle():fe.locked=!1}function Ja(t){return t==fe.code}function Ra(){C.house.power=C.house.power-C.devices.power}const Ot=X(new Date),Ha=B({__name:"DisplayButton",props:{icon:{},color:{}},emits:["click"],setup(t,{emit:e}){const a=t,o=e;function n(){o("click",!0)}return(i,c)=>(u(),f("div",{style:ee({"background-color":a.color?a.color:"var(--color-fg)"}),class:"mybutton",onClick:n},[a.icon?(u(),f("span",{key:0,class:Z(["fas me-2",a.icon])},null,2)):k("",!0),de(i.$slots,"default",{},void 0,!0)],4))}}),F=(t,e)=>{const a=t.__vccOpts||t;for(const[o,n]of e)a[o]=n;return a},Ve=F(Ha,[["__scopeId","data-v-fa36cf33"]]);class Ya{constructor(e){l(this,"id");l(this,"name","GerÃ¤t");l(this,"power",0);l(this,"status","off");l(this,"energy",0);l(this,"runningTime",0);l(this,"configured",!1);l(this,"_showInGraph",!0);l(this,"color","white");l(this,"canSwitch",!1);l(this,"countAsHouse",!1);l(this,"energyPv",0);l(this,"energyBat",0);l(this,"pvPercentage",0);l(this,"tempConfigured",0);l(this,"temp",[300,300,300]);l(this,"on",!1);l(this,"isAutomatic",!0);l(this,"icon","");this.id=e}get showInGraph(){return this._showInGraph}set showInGraph(e){this._showInGraph=e,q()}setShowInGraph(e){this._showInGraph=e}}const W=Y({});function Kt(t){t in W?console.info("Duplicate sh device message: "+t):(W[t]=new Ya(t),W[t].color="var(--color-sh"+Object.values(W).length+")")}class qa{constructor(){l(this,"graphToShow","powermeter");l(this,"cpToShow",0);l(this,"displayLocked",!0);l(this,"_showRelativeArcs",!1);l(this,"showTodayGraph",!0);l(this,"_graphPreference","live");l(this,"_usageStackOrder",0);l(this,"_displayMode","dark");l(this,"_showGrid",!1);l(this,"_smartHomeColors","normal");l(this,"_decimalPlaces",1);l(this,"_showQuickAccess",!0);l(this,"_simpleCpList",!1);l(this,"_shortCpList","no");l(this,"_showAnimations",!0);l(this,"_preferWideBoxes",!1);l(this,"_maxPower",4e3);l(this,"_fluidDisplay",!1);l(this,"_showClock","no");l(this,"_showButtonBar",!0);l(this,"_showCounters",!1);l(this,"_showVehicles",!1);l(this,"_showPrices",!1);l(this,"_debug",!1);l(this,"isEtEnabled",!1);l(this,"etPrice",20.5);l(this,"showRightButton",!0);l(this,"showLeftButton",!0);l(this,"animationDuration",300);l(this,"animationDelay",100);l(this,"zoomGraph",!1)}get showRelativeArcs(){return this._showRelativeArcs}set showRelativeArcs(e){this._showRelativeArcs=e,q()}setShowRelativeArcs(e){this._showRelativeArcs=e}get graphPreference(){return this._graphPreference}set graphPreference(e){this._graphPreference=e,q()}setGraphPreference(e){this._graphPreference=e}get usageStackOrder(){return this._usageStackOrder}set usageStackOrder(e){this._usageStackOrder=e,q()}setUsageStackOrder(e){this._usageStackOrder=e}get displayMode(){return this._displayMode}set displayMode(e){this._displayMode=e,Ka(e)}setDisplayMode(e){this._displayMode=e}get showGrid(){return this._showGrid}set showGrid(e){this._showGrid=e,q()}setShowGrid(e){this._showGrid=e}get decimalPlaces(){return this._decimalPlaces}set decimalPlaces(e){this._decimalPlaces=e,q()}setDecimalPlaces(e){this._decimalPlaces=e}get smartHomeColors(){return this._smartHomeColors}set smartHomeColors(e){this._smartHomeColors=e,Tt(e),q()}setSmartHomeColors(e){this._smartHomeColors=e,Tt(e)}get showQuickAccess(){return this._showQuickAccess}set showQuickAccess(e){this._showQuickAccess=e,q()}setShowQuickAccess(e){this._showQuickAccess=e}get simpleCpList(){return this._simpleCpList}set simpleCpList(e){this._simpleCpList=e,q()}setSimpleCpList(e){this._simpleCpList=e}get shortCpList(){return this._shortCpList}set shortCpList(e){this._shortCpList=e,q()}setShortCpList(e){this._shortCpList=e}get showAnimations(){return this._showAnimations}set showAnimations(e){this._showAnimations=e,q()}setShowAnimations(e){this._showAnimations=e}get preferWideBoxes(){return this._preferWideBoxes}set preferWideBoxes(e){this._preferWideBoxes=e,q()}setPreferWideBoxes(e){this._preferWideBoxes=e}get maxPower(){return this._maxPower}set maxPower(e){this._maxPower=e,q()}setMaxPower(e){this._maxPower=e}get fluidDisplay(){return this._fluidDisplay}set fluidDisplay(e){this._fluidDisplay=e,q()}setFluidDisplay(e){this._fluidDisplay=e}get showClock(){return this._showClock}set showClock(e){this._showClock=e,q()}setShowClock(e){this._showClock=e}get debug(){return this._debug}set debug(e){this._debug=e,q()}setDebug(e){this._debug=e}get showButtonBar(){return this._showButtonBar}set showButtonBar(e){this._showButtonBar=e,q()}setShowButtonBar(e){this._showButtonBar=e}get showCounters(){return this._showCounters}set showCounters(e){this._showCounters=e,q()}setShowCounters(e){this._showCounters=e}get showVehicles(){return this._showVehicles}set showVehicles(e){this._showVehicles=e,q()}setShowVehicles(e){this._showVehicles=e}get showPrices(){return this._showPrices}set showPrices(e){this._showPrices=e,q()}setShowPrices(e){this._showPrices=e}}const _=Y(new qa),Qa=992,kt=Y({x:document.documentElement.clientWidth,y:document.documentElement.clientHeight});function Za(){kt.x=document.documentElement.clientWidth,kt.y=document.documentElement.clientHeight}const Xa=g(()=>kt.x>=Qa),Ce={stop:{mode:_e.stop,name:"Stop",color:"var(--color-fg)",icon:"fa-power-off"},standby:{mode:_e.standby,name:"Standby",color:"var(--color-axis",icon:"fa-pause"},pv_charging:{mode:_e.pv_charging,name:"PV",color:"var(--color-pv",icon:"fa-solar-panel"},scheduled_charging:{mode:_e.scheduled_charging,name:"Zielladen",color:"var(--color-battery)",icon:"fa-bullseye"},instant_charging:{mode:_e.instant_charging,name:"Sofort",color:"var(--color-charging)",icon:"fa-bolt"}};function q(){eo()}function Ka(t){const e=ye("html");e.classed("theme-dark",t=="dark"),e.classed("theme-light",t=="light"),e.classed("theme-blue",t=="blue"),q()}function Tt(t){const e=ye("html");e.classed("shcolors-normal",t=="normal"),e.classed("shcolors-standard",t=="standard"),e.classed("shcolors-advanced",t=="advanced")}const Pe={chargemode:"Der Lademodus fÃ¼r das Fahrzeug an diesem Ladepunkt",vehicle:"Das Fahrzeug, das an diesem Ladepounkt geladen wird",locked:"FÃ¼r das Laden sperren",priority:"Fahrzeuge mit PrioritÃ¤t werden bevorzugt mit mehr Leistung geladen, falls verfÃ¼gbar",timeplan:"Das Laden nach Zeitplan fÃ¼r dieses Fahrzeug aktivieren",minsoc:"Immer mindestens bis zum eingestellten Ladestand laden. Wenn notwendig mit Netzstrom.",minpv:"Durchgehend mit mindestens dem eingestellten Strom laden. Wenn notwendig mit Netzstrom.",pricebased:"Laden bei dynamischem Stromtarif, wenn eingestellter Maximalpreis unterboten wird."};function eo(){const t={};t.hideSH=Object.values(W).filter(e=>!e.showInGraph).map(e=>e.id),t.showLG=_.graphPreference=="live",t.displayM=_.displayMode,t.stackO=_.usageStackOrder,t.showGr=_.showGrid,t.decimalP=_.decimalPlaces,t.smartHomeC=_.smartHomeColors,t.relPM=_.showRelativeArcs,t.maxPow=_.maxPower,t.showQA=_.showQuickAccess,t.simpleCP=_.simpleCpList,t.shortCP=_.shortCpList,t.animation=_.showAnimations,t.wideB=_.preferWideBoxes,t.fluidD=_.fluidDisplay,t.clock=_.showClock,t.showButtonBar=_.showButtonBar,t.showCounters=_.showCounters,t.showVehicles=_.showVehicles,t.showPrices=_.showPrices,t.debug=_.debug,document.cookie="openWBColorTheme="+JSON.stringify(t)+";max-age=16000000;samesite=strict"}const Ze=t=>(le("data-v-3a599c24"),t=t(),ce(),t),to={class:"navigation"},ao={class:"timedisplay"},oo=Ze(()=>s("span",{class:"fas fa-arrow-left px-2"},null,-1)),no=Ze(()=>s("span",{class:"fas fa-charging-station pe-2"},null,-1)),ro=Ze(()=>s("span",{class:"fas fa-charging-station px-2"},null,-1)),so=Ze(()=>s("span",{class:"fas fa-arrow-right pe-2"},null,-1)),io=Ze(()=>s("span",{class:"fas fa-lock px-4"},null,-1)),lo=B({__name:"NavigationBar",setup(t){let e;function a(){let h=Object.values(I).length;_.cpToShow=(_.cpToShow+1)%h}function o(){let h=Object.values(I).length;_.cpToShow=((_.cpToShow-1)%h+h)%h}function n(){_.graphToShow="powermeter"}function i(){_.graphToShow="powergraph"}function c(){_.graphToShow="energymeter"}return je(()=>{e=setInterval(()=>{Ot.value=new Date},1e3)}),xa(()=>{clearInterval(e)}),(h,d)=>(u(),f("div",to,[s("span",ao,x(r(Oa)(r(Ot))),1),w(Ve,{onClick:o},{default:S(()=>[oo,no]),_:1}),w(Ve,{onClick:a},{default:S(()=>[ro,so]),_:1}),w(Ve,{color:r(fe).locked?"var(--color-evu)":"var(--color-pv)",onClick:r(Xt)},{default:S(()=>[io]),_:1},8,["color","onClick"]),w(Ve,{"data-bs-toggle":"modal","data-bs-target":"#statuspage"},{default:S(()=>[R("Status")]),_:1}),w(Ve,{icon:"fa-chart-pie",onClick:n},{default:S(()=>[R("Leistung")]),_:1}),w(Ve,{icon:"fa-chart-line",onClick:i},{default:S(()=>[R("Verlauf")]),_:1}),w(Ve,{icon:"fa-chart-column",onClick:c},{default:S(()=>[R("Energie")]),_:1})]))}}),co=F(lo,[["__scopeId","data-v-3a599c24"]]),uo=["origin"],ho=B({__name:"PMSourceArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let o={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""},n=N;n["zz-empty"]=o;const i=Object.values(N).length-1,c=Nt().value(m=>m.power).startAngle(-Math.PI/2+e.circleGapSize).endAngle(Math.PI/2-e.circleGapSize).sort(null),h=Ut().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius).padAngle(0),d=ye("g#pmSourceArc");return d.selectAll("*").remove(),d.selectAll("sources").data(c(Object.values(n))).enter().append("path").attr("d",h).attr("fill",m=>m.data.color).attr("stroke",(m,v)=>v==i?m.data.power>0?"var(--color-scale)":"null":m.data.color),"pmSourceArc.vue"});return Ma(()=>{let o=N.pv.power+N.evuIn.power+N.batOut.power;o>_.maxPower&&(_.maxPower=o)}),(o,n)=>(u(),f("g",{id:"pmSourceArc",origin:a.value},null,8,uo))}}),po=["origin"],go=B({__name:"PMUsageArc",props:{radius:{},cornerRadius:{},circleGapSize:{},emptyPower:{}},setup(t){const e=t,a=g(()=>{let o={name:"",power:e.emptyPower,energy:0,energyPv:0,energyBat:0,pvPercentage:0,color:"var(--color-bg)",icon:""};const n=[C.evuOut,C.charging].concat(Object.values(W).filter(m=>m.configured&&!m.countAsHouse).sort((m,v)=>v.power-m.power)).concat([C.batIn,C.house]).concat(o),i=n.length-1,c=Nt().value(m=>m.power).startAngle(Math.PI*1.5-e.circleGapSize).endAngle(Math.PI/2+e.circleGapSize).sort(null),h=Ut().innerRadius(e.radius/6*5).outerRadius(e.radius).cornerRadius(e.cornerRadius),d=ye("g#pmUsageArc");return d.selectAll("*").remove(),d.selectAll("consumers").data(c(n)).enter().append("path").attr("d",h).attr("fill",m=>m.data.color).attr("stroke",(m,v)=>v==i?m.data.power>0?"var(--color-scale)":"null":m.data.color),"pmUsageArc.vue"});return(o,n)=>(u(),f("g",{id:"pmUsageArc",origin:a.value},null,8,po))}}),ea=B({__name:"FormatWatt",props:{watt:{}},setup(t){const e=t,a=g(()=>ot(e.watt,_.decimalPlaces));return(o,n)=>x(a.value)}}),mo={key:0,id:"pmLabel"},fo=["x","y","fill","text-anchor"],vo=22,be=B({__name:"PMLabel",props:{x:{},y:{},data:{},props:{},anchor:{},labeltext:{},labelicon:{},labelcolor:{}},setup(t){const e=t,a=g(()=>e.labeltext?e.labeltext:e.props?e.props.icon+" ":e.labelicon?e.labelicon+" ":""),o=g(()=>e.labelcolor?e.labelcolor:e.props?e.props.color:""),n=g(()=>!e.data||e.data.power>0),i=g(()=>e.labeltext?"":"fas");return(c,h)=>n.value?(u(),f("g",mo,[s("text",{x:c.x,y:c.y,fill:o.value,"text-anchor":c.anchor,"font-size":vo,class:"pmLabel"},[s("tspan",{class:Z(i.value)},x(a.value),3),s("tspan",null,[c.data!==void 0?(u(),A(ea,{key:0,watt:c.data.power},null,8,["watt"])):k("",!0)])],8,fo)])):k("",!0)}}),_o={class:"wb-widget p-0 m-0 shadow"},yo={class:"d-flex justify-content-between"},bo={class:"m-4 me-0 mb-0"},wo=s("div",{class:"p-0"},"(title goes here)",-1),ko={class:"p-4 pb-0 ps-0 m-0",style:{"text-align":"right"}},So={class:"px-4 pt-4 pb-2 wb-subwidget"},xo={class:"row"},Mo={class:"col m-0 p-0"},$o={class:"container-fluid m-0 p-0"},Po={key:0},Io=s("hr",null,null,-1),Co={class:"px-4 py-2 wb-subwidget"},Bo={class:"row"},Oo={class:"col"},To={class:"container-fluid m-0 p-0"},dt=B({__name:"WBWidget",props:{variableWidth:{type:Boolean},fullWidth:{type:Boolean}},setup(t){const e=t,a=g(()=>e.fullWidth?"col-12":e.variableWidth&&_.preferWideBoxes?"col-lg-6":"col-lg-4");return(o,n)=>(u(),f("div",{class:Z(["p-2 m-0 d-flex",a.value])},[s("div",_o,[s("div",yo,[s("h3",bo,[de(o.$slots,"title",{},()=>[wo]),de(o.$slots,"subtitle")]),s("div",ko,[de(o.$slots,"buttons")])]),s("div",So,[s("div",xo,[s("div",Mo,[s("div",$o,[de(o.$slots,"default")])])])]),o.$slots.footer!=null?(u(),f("div",Po,[Io,s("div",Co,[s("div",Bo,[s("div",Oo,[s("div",To,[de(o.$slots,"footer")])])])])])):k("",!0)])],2))}});class Lo{constructor(){l(this,"active",!1);l(this,"etPriceList",new Map);l(this,"etProvider","");l(this,"etMaxPrice",0)}get etCurrentPriceString(){const[e]=ne.etPriceList.values();return(Math.round(e*10)/10).toFixed(1)+" ct"}}const ne=Y(new Lo),Vo={id:"powermeter",class:"p-0 m-0"},Ao=["viewBox"],Do=["transform"],Go={transform:"scale(0.9294,1)"},Eo=["x"],xe=500,Me=20,Lt=1,Wo=B({__name:"PowerMeter",setup(t){const e=xe,a=Math.PI/40,o=[[4],[4,6],[1,4,6],[0,2,4,6],[0,2,3,5,6]],n=[{x:-85,y:e/2*1/5},{x:0,y:e/2*1/5},{x:85,y:e/2*1/5},{x:-85,y:e/2*2/5},{x:0,y:e/2*2/5},{x:85,y:e/2*2/5},{x:0,y:e/2*3/5}],i=g(()=>xe/2-Me),c=g(()=>{let T="",E=Object.values(N).filter(j=>j.power>0);return E.length==1&&E[0].name=="PV"?T="Aktueller Verbrauch: ":T="Bezug/Verbrauch: ",T+ot(C.house.power+C.charging.power+C.devices.power+C.batIn.power,_.decimalPlaces)}),h=g(()=>{let T=N.pv.power+N.evuIn.power+N.batOut.power;return _.maxPower>T?ot(_.maxPower,_.decimalPlaces):ot(T,_.decimalPlaces)}),d=g(()=>Object.values(I)),m=g(()=>{let T=0;return _.showRelativeArcs&&(T=_.maxPower-(N.pv.power+N.evuIn.power+N.batOut.power)),T<0?0:T}),v=g(()=>[C.evuOut,C.charging,C.devices,C.batIn,C.house].filter(T=>T.power>0)),O=g(()=>o[v.value.length-1]);function $(T){return n[O.value[T]]}function U(T){return Math.round(d.value[T].soc)}function J(T){return T.length>12?T.slice(0,11)+".":T}const V=g(()=>{const[T]=ne.etPriceList.values();return Math.round(T*10)/10});return(T,E)=>(u(),A(dt,{"full-width":!0},{title:S(()=>[R(" Aktuelle Leistung ")]),default:S(()=>[s("figure",Vo,[(u(),f("svg",{viewBox:"0 0 "+xe+" "+r(e)},[s("g",{transform:"translate("+xe/2+","+r(e)/2+")"},[s("g",Go,[w(ho,{radius:i.value,"corner-radius":Lt,"circle-gap-size":a,"empty-power":m.value},null,8,["radius","empty-power"]),w(go,{"sh-device":r(W),radius:i.value,"corner-radius":Lt,"circle-gap-size":a,"empty-power":m.value},null,8,["sh-device","radius","empty-power"]),w(be,{x:0,y:-r(e)/10*2,data:r(N).pv,props:r(ie).pv,anchor:"middle",config:r(_)},null,8,["y","data","props","config"]),w(be,{x:0,y:-r(e)/10*3,data:r(N).evuIn,props:r(ie).evuIn,anchor:"middle",config:r(_)},null,8,["y","data","props","config"]),w(be,{x:0,y:-r(e)/10,data:r(N).batOut,props:r(ie).batOut,anchor:"middle",config:r(_)},null,8,["y","data","props","config"]),r(ne).active?(u(),A(be,{key:0,x:0,y:-r(e)/10,data:r(N).batOut,props:r(ie).batOut,anchor:"middle",config:r(_)},null,8,["y","data","props","config"])):k("",!0),(u(!0),f(K,null,ge(v.value,(j,M)=>(u(),A(be,{key:M,x:$(M).x,y:$(M).y,data:j,labelicon:j.icon,labelcolor:j.color,anchor:"middle",config:r(_)},null,8,["x","y","data","labelicon","labelcolor","config"]))),128)),d.value.length>0&&r(z)[d.value[0].connectedVehicle]?(u(),A(be,{key:1,x:-xe/2-Me/4+10,y:-r(e)/2+Me+5,labeltext:J(r(z)[d.value[0].connectedVehicle].name)+": "+U(0)+"%",labelcolor:d.value[0].color,anchor:"start",config:r(_)},null,8,["x","y","labeltext","labelcolor","config"])):k("",!0),d.value.length>1&&r(z)[d.value[1].connectedVehicle]?(u(),A(be,{key:2,x:xe/2+Me/4-10,y:-r(e)/2+Me+5,labeltext:J(r(z)[d.value[1].connectedVehicle].name)+": "+U(1)+"%",labelcolor:d.value[1].color,anchor:"end",config:r(_)},null,8,["x","y","labeltext","labelcolor","config"])):k("",!0),r(te).batterySoc>0?(u(),A(be,{key:3,x:-xe/2-Me/4+10,y:r(e)/2-Me+15,labeltext:"Speicher: "+r(te).batterySoc+"%",labelcolor:r(C).batIn.color,anchor:"start",config:r(_)},null,8,["x","y","labeltext","labelcolor","config"])):k("",!0),r(ne).active?(u(),A(be,{key:4,x:xe/2+Me/4-10,y:r(e)/2-Me+15,value:V.value,labeltext:r(ne).etCurrentPriceString,labelcolor:"var(--color-charging)",anchor:"end",config:r(_)},null,8,["x","y","value","labeltext","config"])):k("",!0),w(be,{x:0,y:0,labeltext:c.value,labelcolor:"var(--color-fg)",anchor:"middle",config:r(_)},null,8,["labeltext","config"]),r(_).showRelativeArcs?(u(),f("text",{key:5,x:xe/2-44,y:"2","text-anchor":"middle",fill:"var(--color-axis)","font-size":"12"}," Peak: "+x(h.value),9,Eo)):k("",!0)])],8,Do)],8,Ao))])]),_:1}))}}),we=500,$e=500,G={top:10,right:20,bottom:10,left:25},$t=["charging","house","batIn","devices"];class zo{constructor(){l(this,"data",[]);l(this,"_graphMode","")}get graphMode(){return this._graphMode}set graphMode(e){this._graphMode=e}}const p=Y(new zo);let lt=!0,qe=!0;function Vt(){lt=!1}function At(){qe=!1}function jo(t){qe=t}function Xe(t){p.data=t}const oe=Y({refreshTopicPrefix:"openWB/graph/alllivevaluesJson",updateTopic:"openWB/graph/lastlivevaluesJson",configTopic:"openWB/graph/config/#",initialized:!1,initCounter:0,graphRefreshCounter:0,rawDataPacks:[],duration:0,activate(){p.data=[],this.unsubscribeUpdates(),this.subscribeRefresh(),Ae(this.configTopic),this.initialized=!1,this.initCounter=0,this.graphRefreshCounter=0,this.rawDataPacks=[],Ro(),it.value=!0},deactivate(){this.unsubscribeRefresh(),this.unsubscribeUpdates(),ze(this.configTopic)},subscribeRefresh(){for(let t=1;t<17;t++)Ae(this.refreshTopicPrefix+t)},unsubscribeRefresh(){for(let t=1;t<17;t++)ze(this.refreshTopicPrefix+t)},subscribeUpdates(){Ae(this.updateTopic)},unsubscribeUpdates(){ze(this.updateTopic)}}),H=Y({topic:"openWB/log/daily/#",date:new Date,activate(){if(p.graphMode=="day"||p.graphMode=="today"){p.graphMode=="today"&&(this.date=new Date);const t=this.date.getFullYear().toString()+(this.date.getMonth()+1).toString().padStart(2,"0")+this.date.getDate().toString().padStart(2,"0");Ae(this.topic),xt({command:"getDailyLog",data:{day:t}})}},deactivate(){ze(this.topic)},back(){this.date=new Date(this.date.setTime(this.date.getTime()-864e5))},forward(){this.date=new Date(this.date.setTime(this.date.getTime()+864e5))},setDate(t){this.date=t},getDate(){return this.date}}),ke=Y({topic:"openWB/log/monthly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString()+this.month.toString().padStart(2,"0");p.data=[],Ae(this.topic),xt({command:"getMonthlyLog",data:{month:t}})},deactivate(){ze(this.topic)},back(){this.month-=1,this.month<1&&(this.month=12,this.year-=1),this.activate()},forward(){const t=new Date;t.getFullYear()==this.year?this.month-1<t.getMonth()&&(this.month=this.month+1):(this.month=this.month+1,this.month>12&&(this.month=1,this.year+=1)),this.activate()},getDate(){return new Date(this.year,this.month)}}),Be=Y({topic:"openWB/log/yearly/#",month:new Date().getMonth()+1,year:new Date().getFullYear(),activate(){const t=this.year.toString();p.data=[],Ae(this.topic),xt({command:"getYearlyLog",data:{year:t}})},deactivate(){ze(this.topic)},back(){this.year-=1,this.activate()},forward(){this.year<new Date().getFullYear()&&(this.year=this.year+1,this.activate())},getDate(){return new Date(this.year,this.month)}});function re(t=!1){switch(p.graphMode==""?No(_.graphPreference):p.graphMode=="live"?_.graphPreference="live":_.graphPreference="today",t||(lt=!0,qe=!0),p.graphMode){case"live":H.deactivate(),ke.deactivate(),Be.deactivate(),oe.activate();break;case"today":oe.deactivate(),ke.deactivate(),Be.deactivate(),H.activate();break;case"day":oe.deactivate(),ke.deactivate(),Be.deactivate(),H.activate();break;case"month":oe.deactivate(),H.deactivate(),Be.deactivate(),ke.activate();break;case"year":oe.deactivate(),H.deactivate(),ke.deactivate(),Be.activate();break}}function No(t){p.graphMode=t}function Uo(t,e){e[t]>0&&(P.items[t].energyPv+=1e3/12*(e[t]*(e.pv-e.evuOut))/(e.pv-e.evuOut+e.evuIn+e.batOut),P.items[t].energyBat+=1e3/12*(e[t]*e.batOut)/(e.pv-e.evuOut+e.evuIn+e.batOut))}function Fo(t,e){e[t]>0&&(P.items[t].energyPv+=1e3*(e[t]*(e.pv-e.evuOut))/(e.pv-e.evuOut+e.evuIn+e.batOut),P.items[t].energyBat+=1e3*(e[t]*e.batOut)/(e.pv-e.evuOut+e.evuIn+e.batOut))}const Jo=["evuIn","pv","batIn","evuOut"],Re=X(!1);function Pt(t,e){Object.entries(t).length>0?(Re.value=!1,Object.entries(t.counter).forEach(([a,o])=>{(e.length==0||e.includes(a))&&(P.items.evuIn.energy+=o.energy_imported,P.items.evuOut.energy+=o.energy_exported)}),P.items.pv.energy=t.pv.all.energy_exported,t.bat.all&&(P.items.batIn.energy=t.bat.all.energy_imported,P.items.batOut.energy=t.bat.all.energy_exported),Object.entries(t.cp).forEach(([a,o])=>{a=="all"?P.setEnergy("charging",o.energy_imported):P.setEnergy(a,o.energy_imported)}),P.setEnergy("devices",0),Object.entries(t.sh).forEach(([a,o])=>{P.setEnergy(a,o.energy_imported);const n=a.substring(2);W[+n].countAsHouse||(P.items.devices.energy+=o.energy_imported)}),t.hc&&t.hc.all?P.setEnergy("house",t.hc.all.energy_imported):P.calculateHouseEnergy(),P.keys().map(a=>{Jo.includes(a)||(P.setPvPercentage(a,Math.round((P.items[a].energyPv+P.items[a].energyBat)/P.items[a].energy*100)),$t.includes(a)&&(C[a].energy=P.items[a].energy,C[a].energyPv=P.items[a].energyPv,C[a].energyBat=P.items[a].energyBat,C[a].pvPercentage=P.items[a].pvPercentage))}),p.graphMode=="today"&&(Object.values(I).map(a=>{const o=P.items["cp"+a.id];o&&(a.energyPv=o.energyPv,a.energyBat=o.energyBat,a.pvPercentage=o.pvPercentage)}),Object.values(W).map(a=>{const o=P.items["sh"+a.id];o&&(a.energy=o.energy,a.energyPv=o.energyPv,a.energyBat=o.energyBat,a.pvPercentage=o.pvPercentage)}))):Re.value=!0,it.value=!0}function Ro(){P.keys().map(t=>{$t.includes(t)&&(C[t].energy=P.items[t].energy,C[t].energyPv=0,C[t].energyBat=0,C[t].pvPercentage=0)}),Object.values(I).map(t=>{t.energyPv=0,t.energyBat=0,t.pvPercentage=0}),Object.values(W).map(t=>{t.energyPv=0,t.energyBat=0,t.pvPercentage=0})}const Se=g(()=>{const t=De(p.data,e=>e.date);return t[1]?vt().domain(Array.from({length:t[1]},(e,a)=>a+1)).paddingInner(.4).range([0,we-G.left-2]):vt().range([0,0])});function It(){switch(p.graphMode){case"live":p.graphMode="today",_.showRightButton=!0,re();break;case"today":p.graphMode="day",H.date=new Date,H.back(),re();break;case"day":H.back(),re();break;case"month":ke.back();break;case"year":Be.back();break}}function ta(){const t=new Date;switch(p.graphMode){case"live":break;case"today":p.graphMode="live",_.showRightButton=!1,re();break;case"day":H.forward(),H.date.getDate()==t.getDate()&&H.date.getMonth()==t.getMonth()&&H.date.getFullYear()==t.getFullYear()&&(p.graphMode="today"),re();break;case"month":ke.forward();break;case"year":Be.forward();break}}function aa(){switch(p.graphMode){case"live":It();break;case"day":case"today":p.graphMode="month",re();break;case"month":p.graphMode="year",re();break}}function oa(){switch(p.graphMode){case"year":p.graphMode="month",re();break;case"month":p.graphMode="today",re();break;case"today":case"day":p.graphMode="live",re();break}}function Dt(t){if(p.graphMode=="day"||p.graphMode=="today"){H.setDate(t);const e=new Date;H.date.getDate()==e.getDate()&&H.date.getMonth()==e.getMonth()&&H.date.getFullYear()==e.getFullYear()?p.graphMode="today":p.graphMode="day",re()}}const Ho=["origin","transform"],Yo=B({__name:"PGSourceGraph",props:{width:{},height:{},margin:{}},setup(t){const e=t,a={house:"var(--color-house)",batIn:"var(--color-battery)",inverter:"var(--color-pv)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",evuOut:"var(--color-export)",evuIn:"var(--color-evu)"};var o,n;const i=_.showAnimations?_.animationDuration:0,c=_.showAnimations?_.animationDelay:0,h=g(()=>{const b=ye("g#pgSourceGraph");p.graphMode=="month"||p.graphMode=="year"?M(b):j(b),b.selectAll(".axis").remove();const y=b.append("g").attr("class","axis");return y.call(V.value),y.selectAll(".tick").attr("font-size",12),y.selectAll(".tick line").attr("stroke",E.value).attr("stroke-width",T.value),y.select(".domain").attr("stroke","var(--color-bg)"),"pgSourceGraph.vue"}),d=g(()=>p.graphMode=="month"||p.graphMode=="year"?["evuIn","batOut","selfUsage","evuOut"]:["selfUsage","evuOut","batOut","evuIn"]),m=g(()=>Te().domain([0,p.data.length-1]).range([0,e.width])),v=g(()=>Ft().keys(d.value)),O=g(()=>v.value(p.data)),$=g(()=>Te().range([e.height-10,0]).domain(p.graphMode=="year"?[0,Math.ceil(U.value[1]*10)/10]:[0,Math.ceil(U.value[1])])),U=g(()=>{let b=De(p.data,y=>Math.max(y.pv+y.evuIn+y.batOut,y.selfUsage+y.evuOut));return b[0]!=null&&b[1]!=null?(p.graphMode=="year"&&(b[0]=b[0]/1e3,b[1]=b[1]/1e3),b):[0,0]}),J=g(()=>p.graphMode=="month"||p.graphMode=="year"?-e.width-e.margin.right-22:-e.width),V=g(()=>ut($.value).tickSizeInner(J.value).ticks(4).tickFormat(b=>(b==0?"":Math.round(b*10)/10).toLocaleString(void 0))),T=g(()=>_.showGrid?"0.5":"1"),E=g(()=>_.showGrid?"var(--color-grid)":"var(--color-bg)");function j(b){const y=nt().x((D,se)=>m.value(se)).y($.value(0)),L=nt().x((D,se)=>m.value(se)).y0(D=>$.value(p.graphMode=="year"?D[0]/1e3:D[0])).y1(D=>$.value(p.graphMode=="year"?D[1]/1e3:D[1]));lt?(b.selectAll("*").remove(),o=b.selectAll(".sourceareas").data(O.value).enter().append("path").attr("fill",(D,se)=>a[d.value[se]]).attr("d",D=>y(D)),o.transition().duration(i).delay(c).ease(Ue).attr("d",D=>L(D)),Vt()):o.data(O.value).transition().duration(0).ease(Ue).attr("d",D=>L(D))}function M(b){lt?(b.selectAll("*").remove(),n=b.selectAll(".sourcebar").data(O.value).enter().append("g").attr("fill",(y,L)=>a[d.value[L]]).selectAll("rect").data(y=>y).enter().append("rect").attr("x",(y,L)=>Se.value(p.data[L].date)??0).attr("y",()=>$.value(0)).attr("height",0).attr("width",Se.value.bandwidth()),n.transition().duration(i).delay(c).ease(Ue).attr("height",y=>p.graphMode=="year"?$.value(y[0]/1e3)-$.value(y[1]/1e3):$.value(y[0])-$.value(y[1])).attr("y",y=>p.graphMode=="year"?$.value(y[1]/1e3):$.value(y[1])),Vt()):(b.selectAll("*").remove(),n=b.selectAll(".sourcebar").data(O.value).enter().append("g").attr("fill",(y,L)=>a[d.value[L]]).selectAll("rect").data(y=>y).enter().append("rect").attr("x",(y,L)=>Se.value(p.data[L].date)??0).attr("y",y=>p.graphMode=="year"?$.value(y[1]/1e3):$.value(y[1])).attr("width",Se.value.bandwidth()).attr("height",y=>p.graphMode=="year"?$.value(y[0]/1e3)-$.value(y[1]/1e3):$.value(y[0])-$.value(y[1])))}return(b,y)=>(u(),f("g",{id:"pgSourceGraph",origin:h.value,transform:"translate("+b.margin.left+","+b.margin.top+")"},null,8,Ho))}}),qo=["origin","transform"],Qo=B({__name:"PGUsageGraph",props:{width:{},height:{},margin:{},stackOrder:{}},setup(t){const e=t,a=[["house","charging","devices","batIn"],["charging","devices","house","batIn"],["devices","charging","house","batIn"]],o={house:"var(--color-house)",charging:"var(--color-charging)",batIn:"var(--color-battery)",batOut:"var(--color-battery)",selfUsage:"var(--color-pv)",evuOut:"var(--color-export)",evuIn:"var(--color-evu)",cp0:"var(--color-cp0)",cp1:"var(--color-cp1)",cp2:"var(--color-cp2)",cp3:"var(--color-cp3)",sh1:"var(--color-sh1)",sh2:"var(--color-sh2)",sh3:"var(--color-sh3)",sh4:"var(--color-sh4)",devices:"var(--color-devices)"};var n,i;const c=_.showAnimations?_.animationDuration:0,h=_.showAnimations?_.animationDelay:0,d=g(()=>{const M=ye("g#pgUsageGraph");p.graphMode=="month"||p.graphMode=="year"?j(M):E(M),M.selectAll(".axis").remove();const b=M.append("g").attr("class","axis");return b.call(T.value),b.selectAll(".tick").attr("font-size",12).attr("color","var(--color-axis)"),_.showGrid?b.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):b.selectAll(".tick line").attr("stroke","var(--color-bg)"),b.select(".domain").attr("stroke","var(--color-bg)"),"pgUsageGraph.vue"}),m=g(()=>Ft().keys(U.value)),v=g(()=>m.value(p.data)),O=g(()=>Te().domain([0,p.data.length-1]).range([0,e.width])),$=g(()=>Te().range([e.height+10,2*e.height]).domain(p.graphMode=="year"?[0,Math.ceil(J.value[1]*10)/10]:[0,Math.ceil(J.value[1])])),U=g(()=>{if(p.graphMode!="today"&&p.graphMode!="day")return a[e.stackOrder];{const M=a[e.stackOrder].slice(),b=M.indexOf("charging");M.splice(b,1);const y=/cp\d+/;let L=[];return p.data.length>0&&(L=Object.keys(p.data[0]).reduce((D,se)=>(se.match(y)&&D.push(se),D),[])),L.map((D,se)=>{M.splice(b+se,0,D),o[D]="var(--color-cp"+se+")"}),M}}),J=g(()=>{let M=De(p.data,b=>b.house+b.charging+b.batIn+b.devices);return M[0]!=null&&M[1]!=null?(p.graphMode=="year"&&(M[0]=M[0]/1e3,M[1]=M[1]/1e3),M):[0,0]}),V=g(()=>p.graphMode=="month"||p.graphMode=="year"?-e.width-e.margin.right-22:-e.width),T=g(()=>ut($.value).tickSizeInner(V.value).ticks(4).tickFormat(M=>(M==0?"":Math.round(M*10)/10).toLocaleString(void 0)));function E(M){const b=nt().x((L,D)=>O.value(D)).y($.value(0)),y=nt().x((L,D)=>O.value(D)).y0(L=>$.value(L[0])).y1(L=>$.value(L[1]));_.showAnimations?qe?(M.selectAll("*").remove(),n=M.selectAll(".usageareas").data(v.value).enter().append("path").attr("d",L=>b(L)).attr("fill",(L,D)=>o[U.value[D]]),n.transition().duration(300).delay(100).ease(Ue).attr("d",L=>y(L)),At()):(M.selectAll("*").remove(),M.selectAll(".usageareas").data(v.value).enter().append("path").attr("d",L=>y(L)).attr("fill",(L,D)=>o[U.value[D]])):(M.selectAll("*").remove(),M.selectAll(".usageareas").data(v.value).enter().append("path").attr("d",L=>y(L)).attr("fill",(L,D)=>o[U.value[D]]))}function j(M){qe?(M.selectAll("*").remove(),i=M.selectAll(".usagebar").data(v.value).enter().append("g").attr("fill",(b,y)=>o[a[e.stackOrder][y]]).selectAll("rect").data(b=>b).enter().append("rect").attr("x",(b,y)=>Se.value(p.data[y].date)??0).attr("y",()=>$.value(0)).attr("height",0).attr("width",Se.value.bandwidth()),i.transition().duration(c).delay(h).ease(Ue).attr("y",b=>p.graphMode=="year"?$.value(b[0]/1e3):$.value(b[0])).attr("height",b=>p.graphMode=="year"?$.value(b[1]/1e3)-$.value(b[0]/1e3):$.value(b[1])-$.value(b[0])),At()):(M.selectAll("*").remove(),i=M.selectAll(".usagebar").data(v.value).enter().append("g").attr("fill",(b,y)=>o[a[e.stackOrder][y]]).selectAll("rect").data(b=>b).enter().append("rect").attr("x",(b,y)=>Se.value(p.data[y].date)??0).attr("y",b=>p.graphMode=="year"?$.value(b[0]/1e3):$.value(b[0])).attr("height",b=>p.graphMode=="year"?$.value(b[1]/1e3)-$.value(b[0]/1e3):$.value(b[1])-$.value(b[0])).attr("width",Se.value.bandwidth()))}return(M,b)=>(u(),f("g",{id:"pgUsageGraph",origin:d.value,transform:"translate("+M.margin.left+","+M.margin.top+")"},null,8,qo))}}),Zo=["transform"],Xo=["origin","transform"],Ko=["origin","transform"],en={key:0},tn=["width","height"],an={key:1},on=["y","width","height"],gt=12,nn=B({__name:"PGXAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>at(h.value).ticks(4).tickSizeInner(c.value).tickFormat(_t("%H:%M"))),o=g(()=>$a(h.value).ticks(4).tickSizeInner(c.value+3).tickFormat(_t(""))),n=g(()=>at(Se.value).ticks(4).tickSizeInner(c.value).tickFormat(v=>v.toString())),i=g(()=>at(Se.value).ticks(4).tickSizeInner(c.value).tickFormat(()=>"")),c=g(()=>p.graphMode!=="month"&&p.graphMode!=="year"?_.showGrid?-(e.height/2-7):-10:0),h=g(()=>{let v=De(p.data,O=>O.date);return v[0]&&v[1]?Ye().domain(v).range([0,e.width]):Ye().range([0,0])}),d=g(()=>{let v=ye("g#PGXAxis");return v.selectAll("*").remove(),p.graphMode=="month"||p.graphMode=="year"?v.call(n.value):v.call(a.value),v.selectAll(".tick > text").attr("fill",(O,$)=>$>0||p.graphMode=="month"||p.graphMode=="year"?"var(--color-axis)":"var(--color-bg)").attr("font-size",gt),_.showGrid?v.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):v.selectAll(".tick line").attr("stroke","var(--color-bg)"),v.select(".domain").attr("stroke","var(--color-bg)"),v.append("text").attr("x",-e.margin.left).attr("y",12).attr("fill","var(--color-axis)").attr("font-size",gt).text(p.graphMode=="year"?"MW":"kW").attr("text-anchor","start"),"PGXAxis.vue"}),m=g(()=>{let v=ye("g#PGXAxis2");return v.selectAll("*").remove(),p.graphMode=="month"||p.graphMode=="year"?v.call(i.value):v.call(o.value),v.selectAll(".tick > text").attr("fill",(O,$)=>$>0||p.graphMode=="month"||p.graphMode=="year"?"var(--color-axis)":"var(--color-bg)").attr("font-size",gt),_.showGrid?(v.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"),v.select(".domain").attr("stroke","var(--color-bg)")):v.selectAll(".tick line").attr("stroke","var(--color-bg)"),v.select(".domain").attr("stroke","var(--color-bg)"),"PGXAxis2.vue"});return(v,O)=>(u(),f("g",{transform:"translate("+v.margin.left+","+v.margin.top+")"},[s("g",{id:"PGXAxis",class:"axis",origin:d.value,transform:"translate(0,"+(v.height/2-6)+")"},null,8,Xo),s("g",{id:"PGXAxis2",class:"axis",origin:m.value,transform:"translate(0,"+(v.height/2+10)+")"},null,8,Ko),r(_).showGrid?(u(),f("g",en,[s("rect",{x:"0",y:"0",width:v.width,height:v.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,tn)])):k("",!0),r(_).showGrid?(u(),f("g",an,[s("rect",{x:"0",y:v.height/2+10,width:v.width,height:v.height/2-10,fill:"none",stroke:"var(--color-grid)","stroke-width":"0.5"},null,8,on)])):k("",!0)],8,Zo))}}),rn=["d"],sn=["d","stroke"],ln=["x","y","text-anchor"],mt=B({__name:"PgSoc",props:{width:{},height:{},margin:{},order:{}},setup(t){const e=t,a=g(()=>{let O=De(p.data,$=>$.date);return O[0]&&O[1]?Ye().domain(O).range([0,e.width]):Ye().range([0,0])}),o=g(()=>Te().range([e.height-10,0]).domain([0,100])),n=g(()=>{let $=yt().x(U=>a.value(U.date)).y(U=>o.value(e.order==2?U.batSoc:U["soc"+d.value.connectedVehicle])??o.value(0))(p.data);return $||""}),i=g(()=>e.order==2?"Speicher":d.value.vehicleName),c=g(()=>{switch(e.order){case 0:return"var(--color-cp1)";case 1:return"var(--color-cp2)";case 2:return"var(--color-battery)";default:return"red"}}),h=g(()=>{switch(e.order){case 0:return e.width-3;case 1:return 3;case 2:return e.width/2;default:return 0}}),d=g(()=>{const O=e.order==2?0:e.order;return Object.values(I)[O]}),m=g(()=>{if(p.data.length>0){let O;switch(e.order){case 0:return O=p.data.length-1,o.value(p.data[O]["soc"+d.value.connectedVehicle]+2);case 1:return O=0,o.value(p.data[O]["soc"+d.value.connectedVehicle]+2);case 2:return O=Math.round(p.data.length/2),o.value(p.data[O].batSoc+2);default:return 0}}else return 0}),v=g(()=>{switch(e.order){case 0:return"end";case 1:return"start";case 2:return"middle";default:return"middle"}});return(O,$)=>(u(),f(K,null,[s("path",{class:"soc-baseline",d:n.value,stroke:"var(--color-bg)","stroke-width":"1",fill:"none"},null,8,rn),s("path",{class:"soc-dashes",d:n.value,stroke:c.value,"stroke-width":"1",style:{strokeDasharray:"3,3"},fill:"none"},null,8,sn),s("text",{class:"cpname",x:h.value,y:m.value,style:ee({fill:c.value,fontSize:10}),"text-anchor":v.value},x(i.value),13,ln)],64))}}),cn=["transform"],un=B({__name:"PgSocAxis",props:{width:{},height:{},margin:{}},setup(t){const e=t,a=g(()=>Te().range([e.height-10,0]).domain([0,100])),o=g(()=>Pa(a.value).ticks(5).tickFormat(i=>i.toString()+"%"));function n(){let i=ye("g#PGSocAxis");i.call(o.value),i.selectAll(".tick").attr("font-size",12),i.selectAll(".tick line").attr("stroke","var(--color-bg)"),i.select(".domain").attr("stroke","var(--color-bg)")}return je(()=>{n()}),(i,c)=>(u(),f("g",{id:"PGSocAxis",class:"axis",transform:"translate("+(i.width-20)+",0)"},null,8,cn))}}),dn=t=>(le("data-v-7b8949f3"),t=t(),ce(),t),hn={class:"d-flex align-self-top justify-content-center align-items-center"},pn={class:"input-group input-group-xs"},gn={key:0,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},mn={class:"dropdown-menu"},fn={class:"table optiontable"},vn=["onClick"],_n={key:1,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},yn={class:"dropdown-menu"},bn={class:"table optiontable"},wn=["onClick"],kn={key:2,class:"btn dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},Sn={class:"dropdown-menu"},xn={class:"table optiontable"},Mn=["onClick"],$n=dn(()=>s("span",{class:"fa-solid fa-circle-check"},null,-1)),Pn=[$n],In=B({__name:"DateInput",props:{modelValue:{type:Date,required:!0},mode:{type:String,default:"day"}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=new Date().getFullYear();let n=Array.from({length:10},(U,J)=>o-J);const i=X(!0),c=e,h=[[0,1,2,3],[4,5,6,7],[8,9,10,11]],d=X(a.modelValue.getDate()),m=X(a.modelValue.getMonth()),v=X(a.modelValue.getFullYear()),O=g(()=>{const J=new Date(v.value,m.value,1).getDay();let V=0;switch(m.value){case 1:case 3:case 5:case 7:case 8:case 10:case 12:V=31;break;case 4:case 6:case 9:case 11:V=30;break;case 2:Math.trunc(v.value/4)*4==v.value&&(V=29)}let T=[],E=[0,0,0,0,0,0,0],j=J;for(let M=0;M<V;M++)E[j]=M+1,j==6?(T.push(E),E=[0,0,0,0,0,0,0],j=0):j++;return j<8&&T.push(E),T});function $(){c("update:modelValue",new Date(v.value,m.value,d.value)),i.value=!1}return(U,J)=>(u(),f("span",hn,[s("div",pn,[a.mode=="day"||a.mode=="today"?(u(),f("button",gn,x(d.value),1)):k("",!0),s("div",mn,[s("table",fn,[(u(!0),f(K,null,ge(O.value,(V,T)=>(u(),f("tr",{key:T,class:""},[(u(!0),f(K,null,ge(V,(E,j)=>(u(),f("td",{key:j},[E!=0?(u(),f("span",{key:0,type:"button",class:"btn optionbutton",onClick:M=>d.value=E},x(E),9,vn)):k("",!0)]))),128))]))),128))])]),a.mode!="year"&&a.mode!="live"?(u(),f("button",_n,x(m.value+1),1)):k("",!0),s("div",yn,[s("table",bn,[(u(),f(K,null,ge(h,(V,T)=>s("tr",{key:T,class:""},[(u(!0),f(K,null,ge(V,(E,j)=>(u(),f("td",{key:j,class:"p-0 m-0"},[s("span",{type:"button",class:"btn btn-sm optionbutton",onClick:M=>m.value=E},x(E+1),9,wn)]))),128))])),64))])]),a.mode!="live"?(u(),f("button",kn,x(v.value),1)):k("",!0),s("div",Sn,[s("table",xn,[(u(!0),f(K,null,ge(r(n),(V,T)=>(u(),f("tr",{key:T,class:""},[s("td",null,[s("span",{type:"button",class:"btn optionbutton",onClick:E=>v.value=V},x(V),9,Mn)])]))),128))])]),a.mode!="live"?(u(),f("button",{key:3,class:"button-outline-secondary",type:"button",onClick:$},Pn)):k("",!0)])]))}}),Cn=F(In,[["__scopeId","data-v-7b8949f3"]]),Bn={class:"btn-group m-0",role:"group","aria-label":"radiobar"},On=["id","value"],Tn=B({__name:"RadioBarInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=e,n=g({get(){return a.modelValue},set(h){o("update:modelValue",h)}});function i(h){let d=a.options[h].color?a.options[h].color:"var(--color-fg)";return a.options[h].active?{color:"var(--color-bg)",background:d}:{color:d}}function c(h){let d=h.target;for(;d&&!d.value&&d.parentElement;)d=d.parentElement;d.value&&(n.value=d.value)}return(h,d)=>(u(),f("div",null,[s("div",Bn,[(u(!0),f(K,null,ge(h.options,(m,v)=>(u(),f("button",{id:"radio-"+m.value,key:v,class:Z(["btn btn-outline-secondary btn-sm radiobutton mx-0 mb-0 px-2",m.value==n.value?"active":""]),value:m.value,style:ee(i(v)),onClick:c},[s("span",{style:ee(i(v))},[m.icon?(u(),f("i",{key:0,class:Z(["fa-solid",m.icon])},null,2)):k("",!0),R(" "+x(m.text),1)],4)],14,On))),128))])]))}}),na=F(Tn,[["__scopeId","data-v-20cf8590"]]),ht=t=>(le("data-v-a73ca9f4"),t=t(),ce(),t),Ln=ht(()=>s("i",{class:"fa-solid fa-xl fa-chevron-circle-up"},null,-1)),Vn=[Ln],An=ht(()=>s("span",{class:"fa-solid fa-xl fa-chevron-circle-left arrowButton"},null,-1)),Dn=[An],Gn=ht(()=>s("span",{class:"fa-solid fa-xl fa-gear"},null,-1)),En=[Gn],Wn=ht(()=>s("span",{class:"fa-solid fa-xl fa-circle-check"},null,-1)),zn=[Wn],jn=B({__name:"PgSelector",props:{widgetid:{},showLeftButton:{type:Boolean},showRightButton:{type:Boolean},ignoreLive:{type:Boolean}},emits:["shiftLeft","shiftRight","shiftUp","shiftDown"],setup(t){const e=t,a=X(0),o=g(()=>{switch(p.graphMode){case"live":return e.ignoreLive?"heute":`${oe.duration} min`;case"today":return"heute";case"day":return H.date.getDate()+"."+(H.date.getMonth()+1)+".";case"month":return Ta(ke.month-1,ke.year);case"year":return Be.year.toString();default:return"???"}}),n=["live","today","day","month","year"],i=["Live","Heute","Tag","Monat","Jahr"],c=g({get(){return p.graphMode},set(j){switch(j){case"day":O();break;case"today":$();break;case"live":v();break;case"month":U();break;case"year":J()}}}),h=g(()=>{switch(p.graphMode){case"live":case"today":return H.getDate();case"month":return ke.getDate();default:return H.getDate()}});function d(j){Dt(j)}function m(){a.value+=1,a.value>2&&(a.value=0)}function v(){p.graphMode!="live"&&(p.graphMode="live",re())}function O(){p.graphMode!="day"&&p.graphMode!="today"&&(p.graphMode="day",re())}function $(){p.graphMode!="today"&&(p.graphMode="today",Dt(new Date),re())}function U(){p.graphMode!="month"&&(p.graphMode="month",re())}function J(){p.graphMode!="year"&&(p.graphMode="year",re())}const V=g(()=>a.value>0?{border:"1px solid var(--color-frame)"}:""),T=g(()=>a.value==1?"justify-content-between":"justify-content-end"),E=g(()=>a.value==1?"justify-content-between":"justify-content-center");return(j,M)=>(u(),f("div",{class:"d-flex flex-column justify-content-center pgselector rounded",style:ee(V.value)},[a.value==2?(u(),A(na,{key:0,id:"pgm2",modelValue:c.value,"onUpdate:modelValue":M[0]||(M[0]=b=>c.value=b),class:"m-2",options:n.map((b,y)=>({text:i[y],value:b,color:"var(--color-menu)",active:b==r(p).graphMode}))},null,8,["modelValue","options"])):k("",!0),a.value==1?(u(),f("span",{key:1,type:"button",class:Z(["arrowButton d-flex align-self-center mb-3 mt-3",{disabled:!e.showLeftButton}]),onClick:M[1]||(M[1]=b=>j.$emit("shiftUp"))},Vn,2)):k("",!0),s("div",{class:Z(["d-flex align-items-center",E.value])},[a.value==1?(u(),f("span",{key:0,type:"button",class:Z(["p-1",{disabled:!e.showLeftButton}]),onClick:M[2]||(M[2]=b=>j.$emit("shiftLeft"))},Dn,2)):k("",!0),a.value<2?(u(),f("span",{key:1,type:"button",class:"btn-outline-secondary p-2 px-3 badge rounded-pill datebadge",onClick:m},x(o.value),1)):k("",!0),a.value==2?(u(),A(Cn,{key:2,"model-value":h.value,mode:r(p).graphMode,"onUpdate:modelValue":d},null,8,["model-value","mode"])):k("",!0),a.value==1?(u(),f("span",{key:3,id:"graphRightButton",type:"button",class:Z(["arrowButton fa-solid fa-xl fa-chevron-circle-right p-1",{disabled:!e.showRightButton}]),onClick:M[3]||(M[3]=b=>j.$emit("shiftRight"))},null,2)):k("",!0)],2),s("div",{class:Z(["d-flex align-items-center",T.value])},[a.value==1?(u(),f("span",{key:0,type:"button",class:"p-1",onClick:m},En)):k("",!0),a.value==1?(u(),f("span",{key:1,id:"graphLeftButton",type:"button",class:Z(["arrowButton fa-solid fa-xl fa-chevron-circle-down p-1",{disabled:!e.showLeftButton}]),onClick:M[4]||(M[4]=b=>j.$emit("shiftDown"))},null,2)):k("",!0),a.value>0?(u(),f("span",{key:2,type:"button",class:"p-1",onClick:M[5]||(M[5]=b=>a.value=0)},zn)):k("",!0)],2)],4))}}),ra=F(jn,[["__scopeId","data-v-a73ca9f4"]]),sa=t=>(le("data-v-bb5945e3"),t=t(),ce(),t),Nn={class:"d-flex justify-content-end"},Un=sa(()=>s("span",{class:"fa-solid fa-lg ps-1 fa-magnifying-glass"},null,-1)),Fn=[Un],Jn=["viewBox"],Rn=["transform"],Hn={id:"button"},Yn=["x","y"],qn=sa(()=>s("tspan",{fill:"var(--color-menu)",class:"fas fa-lg"},x("ï"),-1)),Qn=[qn],Zn=2,Xn="Leistung / Ladestand ",Kn=B({__name:"PowerGraph",setup(t){function e(){let o=_.usageStackOrder+1;o>Zn&&(o=0),_.usageStackOrder=o,jo(!0)}function a(){_.zoomGraph=!_.zoomGraph}return(o,n)=>(u(),A(dt,{"full-width":!0},{title:S(()=>[R(x(Xn))]),buttons:S(()=>[s("div",Nn,[w(ra,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,"ignore-live":!1,onShiftLeft:r(It),onShiftRight:r(ta),onShiftUp:r(aa),onShiftDown:r(oa)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"]),r(Xa)?(u(),f("span",{key:0,type:"button",class:"ms-1 p-0 pt-1",onClick:a},Fn)):k("",!0)])]),default:S(()=>[s("figure",{id:"powergraph",class:"p-0 m-0",onClick:e},[(u(),f("svg",{viewBox:"0 0 "+r(we)+" "+r($e)},[w(Yo,{width:r(we)-r(G).left-2*r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G)},null,8,["width","height","margin"]),w(Qo,{width:r(we)-r(G).left-2*r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G),"stack-order":r(_).usageStackOrder},null,8,["width","height","margin","stack-order"]),w(nn,{width:r(we)-r(G).left-2*r(G).right,height:r($e)-r(G).top-r(G).bottom,margin:r(G),"graph-data":r(p)},null,8,["width","height","margin","graph-data"]),s("g",{transform:"translate("+r(G).left+","+r(G).top+")"},[(r(p).graphMode=="day"||r(p).graphMode=="today"||r(p).graphMode=="live")&&Object.values(r(I)).length>0?(u(),A(mt,{key:0,width:r(we)-r(G).left-2*r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G),order:0},null,8,["width","height","margin"])):k("",!0),(r(p).graphMode=="day"||r(p).graphMode=="today"||r(p).graphMode=="live")&&Object.values(r(I)).length>1?(u(),A(mt,{key:1,width:r(we)-r(G).left-2*r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G),order:1},null,8,["width","height","margin"])):k("",!0),(r(p).graphMode=="day"||r(p).graphMode=="today")&&r(te).isBatteryConfigured?(u(),A(mt,{key:2,width:r(we)-r(G).left-2*r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G),order:2},null,8,["width","height","margin"])):k("",!0),r(p).graphMode=="day"||r(p).graphMode=="today"?(u(),A(un,{key:3,width:r(we)-r(G).left-r(G).right,height:(r($e)-r(G).top-r(G).bottom)/2,margin:r(G)},null,8,["width","height","margin"])):k("",!0)],8,Rn),s("g",Hn,[s("text",{x:r(we),y:r($e)-10,color:"var(--color-menu)","text-anchor":"end"},Qn,8,Yn)])],8,Jn))])]),_:1}))}}),er=F(Kn,[["__scopeId","data-v-bb5945e3"]]),tr=["id"],ar=["x","width","height","fill"],or=["x","width","height"],nr=["x","y","width","height"],rr=B({__name:"EmBar",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.height-e.yScale(e.item.energy)-e.margin.top-e.margin.bottom),o=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyPv)-e.margin.top-e.margin.bottom:0),n=g(()=>e.item.energyPv>0?e.height-e.yScale(e.item.energyBat)-e.margin.top-e.margin.bottom:0);return(i,c)=>(u(),f("g",{id:"bar-"+e.item.name,transform:"scale(1,-1) translate (0,-445)"},[s("rect",{class:"bar",x:e.xScale(i.item.name),y:"0",width:e.xScale.bandwidth(),height:a.value,fill:i.item.color},null,8,ar),s("rect",{class:"bar",x:e.xScale(i.item.name)+e.xScale.bandwidth()/6,y:"0",width:e.xScale.bandwidth()*2/3,height:o.value,fill:"var(--color-pv)","fill-opacity":"66%"},null,8,or),s("rect",{class:"bar",x:e.xScale(i.item.name)+e.xScale.bandwidth()/6,y:o.value,width:e.xScale.bandwidth()*2/3,height:n.value,fill:"var(--color-battery)","fill-opacity":"66%"},null,8,nr)],8,tr))}}),sr={id:"emBargraph"},ir=s("animateTransform",{"attribute-name":"transform",type:"scale",from:"1 0",to:"1 1",begin:"0s",dur:"2s"},null,-1),lr=B({__name:"EMBarGraph",props:{plotdata:{},xScale:{},yScale:{},margin:{},height:{}},setup(t){const e=t;function a(n){if(n.name=="PV"){const i=p.graphMode=="live"||p.graphMode=="day"?N:P.items,h=(p.graphMode=="live"||p.graphMode=="day"?C:P.items).evuOut.energy,d=i.pv.energy;return Math.round((d-h)/d*100)}else if(n.name=="Netz"){const i=p.graphMode=="live"||p.graphMode=="day"?N:P.items,c=p.graphMode=="live"||p.graphMode=="day"?C:P.items,h=c.evuOut.energy,d=i.evuIn.energy,m=i.pv.energy,v=i.batOut.energy,O=c.batIn.energy;return Math.round((m+v-h-O)/(m+v+d-h-O)*100)}else return n.pvPercentage}function o(n){return n.name=="PV"?"Eigen":"Aut"}return(n,i)=>(u(),f("g",sr,[(u(!0),f(K,null,ge(e.plotdata,(c,h)=>(u(),f("g",{key:h},[w(rr,{item:c,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":o(c),autarchy:a(c)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128)),ir]))}}),cr=["origin"],ur=B({__name:"EMYAxis",props:{yScale:{type:[Function,Object]},width:{},fontsize:{}},setup(t){const e=t,a=g(()=>ut(e.yScale).tickFormat(n=>n>0?(n/1e3).toString():"").ticks(6).tickSizeInner(-e.width)),o=g(()=>{const n=ye("g#emYAxis");return n.attr("class","axis").call(a.value),n.append("text").attr("y",6).attr("dy","0.71em").attr("text-anchor","end").text("energy"),n.selectAll(".tick").attr("font-size",e.fontsize),_.showGrid?n.selectAll(".tick line").attr("stroke","var(--color-grid)").attr("stroke-width","0.5"):n.selectAll(".tick line").attr("stroke","var(--color-bg)"),n.select(".domain").attr("stroke","var(--color-bg)"),"emYAxis.vue"});return(n,i)=>(u(),f("g",{id:"emYAxis",class:"axis",origin:o.value},null,8,cr))}}),dr=["id"],hr=["x","y","font-size"],pr=["x","y","font-size","fill"],gr=["x","y","font-size","fill"],mr=B({__name:"EmLabel",props:{item:{},xScale:{},yScale:{},margin:{},height:{},barcount:{},autarchy:{},autText:{}},setup(t){const e=t,a=g(()=>e.autarchy?e.yScale(e.item.energy)-25:e.yScale(e.item.energy)-10),o=g(()=>{let d=16,m=e.barcount;return m<=5?d=16:m==6?d=14:m>6&&m<=8?d=13:m==9?d=11:m==10?d=10:d=9,d}),n=g(()=>{let d=12,m=e.barcount;return m<=5?d=12:m==6?d=11:m>6&&m<=8||m==9?d=8:m==10?d=7:d=6,d});function i(d,m){return m.length>n.value?m.substring(0,n.value)+".":m}function c(){return e.autarchy?e.autText+": "+e.autarchy.toLocaleString(void 0)+" %":""}function h(){return"var(--color-pv)"}return(d,m)=>(u(),f("g",{id:"barlabel-"+e.item.name},[s("text",{x:e.xScale(d.item.name)+e.xScale.bandwidth()/2,y:a.value,"font-size":o.value,"text-anchor":"middle",fill:"var(--color-menu)"},x(r(Rt)(d.item.energy,r(_).decimalPlaces,!1)),9,hr),s("text",{x:e.xScale(d.item.name)+e.xScale.bandwidth()/2,y:e.yScale(d.item.energy)-10,"font-size":o.value-2,"text-anchor":"middle",fill:h()},x(c()),9,pr),s("text",{x:e.xScale(d.item.name)+e.xScale.bandwidth()/2,y:e.height-e.margin.bottom-5,"font-size":o.value,"text-anchor":"middle",fill:d.item.color,class:Z(d.item.icon.length<=2?"fas":"")},x(i(d.item.name,d.item.icon)),11,gr)],8,dr))}}),fr={id:"emBarLabels"},vr=B({__name:"EMLabels",props:{plotdata:{},xScale:{},yScale:{},height:{},margin:{}},setup(t){const e=t;function a(n){if(n.name=="PV"){const i=p.graphMode=="live"||p.graphMode=="day"?N:P.items,h=(p.graphMode=="live"||p.graphMode=="day"?C:P.items).evuOut.energy,d=i.pv.energy;return Math.round((d-h)/d*100)}else if(n.name=="Netz"){const i=p.graphMode=="live"||p.graphMode=="day"?N:P.items,c=p.graphMode=="live"||p.graphMode=="day"?C:P.items,h=c.evuOut.energy,d=i.evuIn.energy,m=i.pv.energy,v=i.batOut.energy,O=c.batIn.energy;return m+v-h-O>0?Math.round((m+v-h-O)/(m+v+d-h-O)*100):0}else return n.pvPercentage}function o(n){return n.name=="PV"?"Eigen":"Aut"}return(n,i)=>(u(),f("g",fr,[(u(!0),f(K,null,ge(e.plotdata,(c,h)=>(u(),f("g",{key:h},[w(mr,{item:c,"x-scale":e.xScale,"y-scale":e.yScale,margin:e.margin,height:e.height,barcount:e.plotdata.length,"aut-text":o(c),autarchy:a(c)},null,8,["item","x-scale","y-scale","margin","height","barcount","aut-text","autarchy"])]))),128))]))}}),_r={id:"energymeter",class:"p-0 m-0"},yr={viewBox:"0 0 500 500"},br=["transform"],wr=["x"],kr={key:0},Gt=500,ft=500,Et=12,Sr="Energie",xr=B({__name:"EnergyMeter",setup(t){const e={top:25,bottom:30,left:25,right:0},a=g(()=>{let c=Object.values(N),h=i.value,d=P.values(),m=[];switch(_.debug&&(console.debug("----------------------- source summary -----------------"),console.debug(N),console.debug("----------------------- usage details ------------------"),console.debug(i.value),console.debug("----------------------- historic summary ---------------"),console.debug(P),console.debug("--------------------------------------------------------")),it.value==!0&&(it.value=!1),p.graphMode){default:case"live":case"today":m=c.concat(h).filter(v=>v.energy>0);break;case"day":case"month":case"year":d.length==0?Re.value=!0:(Re.value=!1,m=d.filter(v=>v.energy>0))}return m}),o=g(()=>vt().range([0,Gt-e.left-e.right]).domain(a.value.map(c=>c.name)).padding(.4)),n=g(()=>Te().range([ft-e.bottom-e.top,15]).domain([0,Ia(a.value,c=>c.energy)])),i=g(()=>{const c=Object.values(I).length,h=Object.values(W).filter(d=>d.configured).length;return[C.evuOut,C.devices,C.charging].concat(c>1?Object.values(I).map(d=>d.toPowerItem()):[]).concat(h>1?Object.values(W).filter(d=>d.configured&&d.showInGraph):[]).concat([C.batIn,C.house])});return(c,h)=>(u(),A(dt,{"full-width":!0},{title:S(()=>[R(x(Sr))]),buttons:S(()=>[w(ra,{widgetid:"graphsettings","show-left-button":!0,"show-right-button":!0,"ignore-live":!0,onShiftLeft:r(It),onShiftRight:r(ta),onShiftUp:r(aa),onShiftDown:r(oa)},null,8,["onShiftLeft","onShiftRight","onShiftUp","onShiftDown"])]),default:S(()=>[s("figure",_r,[(u(),f("svg",yr,[s("g",{transform:"translate("+e.left+","+e.top+")"},[w(lr,{plotdata:a.value,"x-scale":o.value,"y-scale":n.value,height:ft,margin:e},null,8,["plotdata","x-scale","y-scale"]),w(ur,{"y-scale":n.value,width:Gt,fontsize:Et,config:r(_)},null,8,["y-scale","config"]),s("text",{x:-e.left,y:"-15",fill:"var(--color-axis)","font-size":Et},x(r(p).graphMode=="year"?"MWh":"kWh"),9,wr),w(vr,{plotdata:a.value,"x-scale":o.value,"y-scale":n.value,height:ft,margin:e,config:r(_)},null,8,["plotdata","x-scale","y-scale","config"])],8,br)]))]),r(Re)?(u(),f("p",kr,"No data")):k("",!0)]),_:1}))}}),ia=t=>(le("data-v-f305ced0"),t=t(),ce(),t),Mr=["id"],$r={class:"modal-dialog modal-lg modal-fullscreen-lg-down"},Pr={class:"modal-content"},Ir={class:"modal-header"},Cr={class:"modal-title"},Br=ia(()=>s("button",{type:"button",class:"btn-close buttonTextSize d-flex justify-content-center pt-3 pb-0","data-bs-dismiss":"modal"},[s("i",{class:"fa-solid fa-lg fa-rectangle-xmark m-0 p-0"})],-1)),Or={class:"modal-body",style:{"background-color":"var(--color-menu)"}},Tr=ia(()=>s("button",{class:"btn btn-secondary closebutton float-end mt-3 ms-1","data-bs-dismiss":"modal"}," SchlieÃen ",-1)),Lr=B({__name:"ModalComponent",props:{modalId:{}},setup(t){const e=t;return je(()=>{}),(a,o)=>(u(),f("div",{id:e.modalId,class:"modal fade"},[s("div",$r,[s("div",Pr,[s("div",Ir,[s("h3",Cr,[de(a.$slots,"title",{},void 0,!0)]),Br]),s("div",Or,[de(a.$slots,"default",{},void 0,!0),Tr])])])],8,Mr))}}),Wt=F(Lr,[["__scopeId","data-v-f305ced0"]]),Vr={class:"digit",type:"button"},Ar=B({__name:"PadButton",props:{modelValue:{},color:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=X(!1);function n(){o.value=!0,c("update:modelValue",a.modelValue),setTimeout(()=>{o.value=!1},300)}const i=g(()=>o.value?{"background-color":"white",color:"black"}:{"background-color":a.color??"black"}),c=e;return(h,d)=>(u(),f("div",{class:"padbutton",style:ee(i.value),onClick:n},[s("span",Vr,[de(h.$slots,"default",{},void 0,!0)])],4))}}),et=F(Ar,[["__scopeId","data-v-d100237f"]]),la=t=>(le("data-v-65c7ab86"),t=t(),ce(),t),Dr={class:"numberpad"},Gr={class:"codedisplay"},Er={class:"numberentry"},Wr=la(()=>s("span",{class:"fas fa-delete-left"},null,-1)),zr=la(()=>s("span",{class:"fas fa-circle-check"},null,-1)),jr=B({__name:"NumberPad",props:{modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const o=X(t.modelValue),n=e,i=g(()=>o.value.length==0?"Bitte geben Sie den PIN ein":"*".repeat(o.value.length));function c(h){h==-1?o.value=o.value.slice(0,-1):h==-2?(n("update:modelValue",o.value),o.value=""):o.value=o.value+h.toString()}return(h,d)=>(u(),f("div",Dr,[s("p",Gr,x(i.value),1),s("div",Er,[(u(),f(K,null,ge(9,m=>w(et,{key:m,"model-value":m,"onUpdate:modelValue":c},{default:S(()=>[R(x(m),1)]),_:2},1032,["model-value"])),64)),w(et,{"model-value":0,"onUpdate:modelValue":c},{default:S(()=>[R("0")]),_:1}),w(et,{"model-value":-1,color:"var(--color-devices)","onUpdate:modelValue":c},{default:S(()=>[Wr]),_:1}),w(et,{"model-value":-2,color:"var(--color-devices)","data-bs-dismiss":"modal","onUpdate:modelValue":c},{default:S(()=>[zr]),_:1})])]))}}),Nr=F(jr,[["__scopeId","data-v-65c7ab86"]]),Ke=t=>(le("data-v-871ca405"),t=t(),ce(),t),Ur={class:"statustable"},Fr=Ke(()=>s("span",null,"IP-Adresse:",-1)),Jr=Ke(()=>s("span",null,"Systemzeit:",-1)),Rr=Ke(()=>s("span",null,"Version:",-1)),Hr=Ke(()=>s("span",null,"Version (Details):",-1)),Yr=Ke(()=>s("span",null,"Entwicklungszweig:",-1)),qr=B({__name:"StatusPage",setup(t){return(e,a)=>(u(),f("div",Ur,[Fr,s("span",null,x(r(te).ipAddress),1),Jr,s("span",null,x(new Date(r(te).systemTime*1e3).toLocaleString(void 0)),1),Rr,s("span",null,x(r(te).version),1),Hr,s("span",null,x(r(te).versionDetails),1),Yr,s("span",null,x(r(te).devBranch),1)]))}}),Qr=F(qr,[["__scopeId","data-v-871ca405"]]);function Zr(t,e){t=="openWB/graph/boolDisplayLiveGraph"?te.displayLiveGraph=+e==1:t.match(/^openwb\/graph\/alllivevaluesJson[1-9][0-9]*$/i)?Xr(t,e):t=="openWB/graph/lastlivevaluesJson"?Kr(t,e):t=="openWB/graph/config/duration"&&(oe.duration=JSON.parse(e))}function Xr(t,e){if(!oe.initialized){let a=[];const o=e.toString().split(`
`);o.length>1?a=o.map(c=>JSON.parse(c)):a=[];const n=t.match(/(\d+)$/g),i=n?n[0]:"";i!=""&&typeof oe.rawDataPacks[+i-1]>"u"&&(oe.rawDataPacks[+i-1]=a,oe.initCounter++)}if(oe.initCounter==16){const a=[];oe.unsubscribeRefresh(),oe.initialized=!0,oe.rawDataPacks.map(o=>{o.map(n=>{const i=ca(n);a.push(i)})}),Xe(a),oe.subscribeUpdates()}}function Kr(t,e){const a=JSON.parse(e),o=ca(a);oe.graphRefreshCounter++,Xe(p.data.concat(o)),oe.graphRefreshCounter>60&&oe.activate()}function ca(t){const e={};e.date=es(t.time).valueOf(),+t.grid>0?(e.evuIn=+t.grid,e.evuOut=0):+t.grid<=0?(e.evuIn=0,e.evuOut=-t.grid):(e.evuIn=0,e.evuOut=0),+t["pv-all"]>=0?(e.pv=+t["pv-all"],e.inverter=0):(e.pv=0,e.inverter=-t["pv-all"]),e.house=+t["house-power"],+t["bat-all-power"]>0?(e.batOut=0,e.batIn=+t["bat-all-power"]):+t["bat-all-power"]<0?(e.batOut=-t["bat-all-power"],e.batIn=0):(e.batOut=0,e.batIn=0),t["bat-all-soc"]?e.batterySoc=+t["bat-all-soc"]:e.batterySoc=0,t["ev0-soc"]&&(e.soc0=+t["ev0-soc"]),t["ev1-soc"]&&(e.soc1=+t["ev1-soc"]),e.charging=+t["charging-all"];for(let a=0;a<10;a++){const o="cp"+a;e[o]=+(t[o+"-power"]??0)}return e.selfUsage=e.pv-e.evuOut,e.selfUsage<0&&(e.selfUsage=0),e.devices=0,e}function es(t){const e=new Date(Date.now()),a=864e5;let o=new Date;const n=rt("%H:%M:%S")(t);return n&&(o=n,o.setDate(e.getDate()),o.setMonth(e.getMonth()),o.setFullYear(e.getFullYear()),o.getHours()>e.getHours()&&(o=new Date(o.getTime()-a))),o}const ts=["evuIn","pv","batIn","evuOut"];let ct=[];function as(t,e){const a=JSON.parse(e).entries,o=JSON.parse(e).totals;Mt(),ct=[],$t.map(i=>{P.setEnergyPv(i,0),P.setEnergyBat(i,0)});const n=os(a);Xe(n),Pt(o,ct),_.debug&&(console.debug("---------------------------------------- Graph Data ---------------------------"),console.debug("--- Incoming graph data:"),console.debug(a),console.debug("data to be displayed:"),console.debug(n),console.debug("-------------------------------------------------------------------------------")),p.graphMode=="today"&&setTimeout(()=>H.activate(),3e5)}function os(t){const e=[];let a={};return t.map(o=>{a=ns(o);const n=a;e.push(n)}),e}function ns(t){const e={};if(p.graphMode=="day"||p.graphMode=="today")if(typeof t.date=="number")e.date=new Date(+t.date*1e3).getTime();else{const o=rt("%H:%M")(t.date);o&&(o.setMonth(H.date.getMonth()),o.setDate(H.date.getDate()),o.setFullYear(H.date.getFullYear()),e.date=o.getTime())}else if(typeof t.date=="string"){const o=rt("%Y%m%d")(t.date);o&&(e.date=o.getDate())}return e.evuOut=0,e.evuIn=0,Object.entries(t.counter).forEach(([o,n])=>{n.grid&&(e.evuOut+=n.power_exported,e.evuIn+=n.power_imported,ct.includes(o)||ct.push(o))}),e.evuOut==0&&e.evuIn==0&&Object.entries(t.counter).forEach(o=>{e.evuOut+=o[1].power_exported,e.evuIn+=o[1].power_imported}),e.pv=t.pv.all.power_exported,Object.entries(t.bat).length>0?(e.batIn=t.bat.all.power_imported,e.batOut=t.bat.all.power_exported,e.batSoc=t.bat.all.soc??0):(e.batIn=0,e.batOut=0,e.batSoc=0),Object.entries(t.cp).forEach(([o,n])=>{o!="all"?(e[o]=n.power_imported,P.keys().includes(o)||P.addItem(o)):e.charging=n.power_imported}),Object.entries(t.ev).forEach(([o,n])=>{o!="all"&&(e["soc"+o.substring(2)]=n.soc)}),e.devices=0,Object.entries(t.sh).forEach(([o,n])=>{o!="all"&&(e[o]=n.power_imported??0,e.devices+=n.power_imported??0,P.keys().includes(o)||P.addItem(o))}),e.selfUsage=e.pv-e.evuOut,t.hc&&t.hc.all?e.house=t.hc.all.power_imported:e.house=e.evuIn+e.batOut+e.pv-e.evuOut-e.charging-e.devices-e.batOut,e.evuIn+e.batOut+e.pv>0?P.keys().filter(o=>!ts.includes(o)).map(o=>{Uo(o,e)}):Object.keys(e).map(o=>{e[o+"Pv"]=0,e[o+"Bat"]=0}),e}let tt={};const Ct=["charging","house","batIn","devices"],rs=["evuIn","pv","batIn","evuOut"];let He=[];function ss(t,e){const a=JSON.parse(e).entries,o=JSON.parse(e).totals;Mt(),He=[],Ct.map(n=>{P.items[n].energyPv=0,P.items[n].energyBat=0}),a.length>0&&Xe(ua(a)),Pt(o,[])}function is(t,e){const a=JSON.parse(e).entries,o=JSON.parse(e).totals;Mt(),He=[],Ct.forEach(n=>{P.items[n].energyPv=0,P.items[n].energyBat=0}),Xe(ua(a)),Pt(o,[])}function ua(t){const e=[];let a={};return tt={},t.map(o=>{a=ls(o),e.push(a),Object.keys(a).forEach(n=>{n!="date"&&(a[n]<0&&(console.warn(`Negative energy value for ${n} in row ${a.date}. Ignoring the value.`),a[n]=0),tt[n]?tt[n]+=a[n]:tt[n]=a[n])})}),e}function ls(t){const e={},a=rt("%Y%m%d")(t.date);a&&(e.date=p.graphMode=="month"?a.getDate():a.getMonth()+1),e.evuOut=0,e.evuIn=0;let o=0,n=0;return Object.entries(t.counter).forEach(([c,h])=>{o+=h.energy_exported,n+=h.energy_imported,h.grid&&(e.evuOut+=h.energy_exported,e.evuIn+=h.energy_imported,He.includes(c)||He.push(c))}),He.length==0&&(e.evuOut=o,e.evuIn=n),e.pv=t.pv.all.energy_exported,Object.entries(t.bat).length>0?(t.bat.all.energy_imported>=0?e.batIn=t.bat.all.energy_imported:(console.warn("ignoring negative value for batIn on day "+e.date),e.batIn=0),t.bat.all.energy_exported>=0?e.batOut=t.bat.all.energy_exported:(console.warn("ignoring negative value for batOut on day "+e.date),e.batOut=0)):(e.batIn=0,e.batOut=0),Object.entries(t.cp).forEach(([c,h])=>{c!="all"?(P.keys().includes(c)||P.addItem(c),e[c]=h.energy_imported):e.charging=h.energy_imported}),Object.entries(t.ev).forEach(([c,h])=>{c!="all"&&(e["soc-"+c]=h.soc)}),e.devices=Object.entries(t.sh).reduce((c,h)=>(P.keys().includes(h[0])||P.addItem(h[0]),h[1].energy_imported>=0?c+=h[1].energy_imported:console.warn(`Negative energy value for device ${h[0]} in row ${e.date}. Ignoring this value`),c),0),e.house=e.pv+e.evuIn+e.batOut-e.evuOut-e.batIn-e.charging,e.selfUsage=e.pv-e.evuOut,e.evuIn+e.batOut+e.pv>0?P.keys().filter(c=>!rs.includes(c)).map(c=>{Fo(c,e)}):Ct.map(c=>{e[c+"Pv"]=0,e[c+"Bat"]=0}),e}class cs{constructor(e){l(this,"id");l(this,"dailyYieldExport",0);l(this,"dailyYieldImport",0);l(this,"exported",0);l(this,"faultState",0);l(this,"faultStr","");l(this,"imported",0);l(this,"power",0);l(this,"soc",0);this.id=e}}class us{constructor(){l(this,"dailyExport",0);l(this,"dailyImport",0);l(this,"exported",0);l(this,"imported",0);l(this,"power",0);l(this,"soc",0)}}const pe=Y({});Y(new us);function ds(t){t in pe?console.info("Duplicate battery message: "+t):pe[t]=new cs(t)}function hs(){Object.keys(pe).forEach(t=>{delete pe[parseInt(t)]})}function ps(t,e){const a=gs(t);if(a&&!(a in pe)){console.warn("Invalid battery index received: "+a);return}t=="openWB/bat/config/configured"?te.isBatteryConfigured=e=="true":t=="openWB/bat/get/power"?+e>0?(C.batIn.power=+e,N.batOut.power=0):(C.batIn.power=0,N.batOut.power=-e):t=="openWB/bat/get/soc"?te.batterySoc=+e:t=="openWB/bat/get/daily_exported"?N.batOut.energy=+e:t=="openWB/bat/get/daily_imported"?C.batIn.energy=+e:a&&(t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_export$/i)?pe[a].dailyYieldExport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/daily_yield_import$/i)?pe[a].dailyYieldImport=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/exported$/i)?pe[a].exported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_state$/i)?pe[a].faultState=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/fault_str$/i)?pe[a].faultStr=e:t.match(/^openwb\/bat\/[0-9]+\/get\/imported$/i)?pe[a].imported=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/power$/i)?pe[a].power=+e:t.match(/^openwb\/bat\/[0-9]+\/get\/soc$/i)&&(pe[a].soc=+e))}function gs(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function ms(t,e){if(t=="openWB/optional/et/provider")JSON.parse(e).type==null?ne.active=!1:(ne.active=!0,ne.etProvider=JSON.parse(e).name);else if(t=="openWB/optional/et/get/prices"){const a=JSON.parse(e);ne.etPriceList=new Map,Object.keys(a).map(o=>{ne.etPriceList.set(new Date(+o*1e3),a[o]*1e5)})}}function fs(t,e){const a=da(t);if(a&&!(a in I)){console.warn("Invalid chargepoint id received: "+a);return}if(t=="openWB/chargepoint/get/power"?C.charging.power=+e:t=="openWB/chargepoint/get/daily_imported"&&(C.charging.energy=+e),t=="openWB/chargepoint/get/daily_exported")te.cpDailyExported=+e;else if(a){if(t.match(/^openwb\/chargepoint\/[0-9]+\/config$/i))if(I[a]){const o=JSON.parse(e);I[a].name=o.name,I[a].icon=o.name,ie["cp"+a]?(ie["cp"+a].name=o.name,ie["cp"+a].icon=o.name):ie["cp"+a]={name:o.name,icon:o.name,color:"var(--color-charging)"}}else console.warn("invalid chargepoint index: "+a);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/state_str$/i))I[a].stateStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_str$/i))I[a].faultStr=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/fault_state$/i))I[a].faultState=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/power$/i))I[a].power=+e;else if(t.match(/^openWB\/chargepoint\/[0-9]+\/get\/daily_imported$/i))I[a].dailyYield=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/plug_state$/i))I[a].isPluggedIn=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/charge_state$/i))I[a].isCharging=e=="true";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/manual_lock$/i))I[a].updateIsLocked(e=="true");else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/enabled$/i))I[a].isEnabled=e=="1";else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/phases_in_use/i))I[a].phasesInUse=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/current/i))I[a].current=+e;else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/currents/i))I[a].currents=JSON.parse(e);else if(t.match(/^openwb\/chargepoint\/[0-9]+\/set\/log/i)){const o=JSON.parse(e);I[a].chargedSincePlugged=o.imported_since_plugged}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/soc$/i)){const o=JSON.parse(e);I[a].soc=o.soc,I[a].waitingForSoc=!1,I[a].rangeCharged=o.range_charged,I[a].rangeUnit=o.range_unit}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/info$/i)){const o=JSON.parse(e);I[a].vehicleName=String(o.name),I[a].updateConnectedVehicle(+o.id)}else if(t.match(/^openwb\/chargepoint\/[0-9]+\/get\/connected_vehicle\/config$/i)){const o=JSON.parse(e);switch(o.chargemode){case"instant_charging":I[a].updateChargeMode(_e.instant_charging);break;case"pv_charging":I[a].updateChargeMode(_e.pv_charging);break;case"scheduled_charging":I[a].updateChargeMode(_e.scheduled_charging);break;case"standby":I[a].updateChargeMode(_e.standby);break;case"stop":I[a].updateChargeMode(_e.stop);break}I[a].chargeTemplate=o.charge_template,I[a].averageConsumption=o.average_consumption}}}function vs(t,e){const a=da(t);if(a!=null){if(!(a in z)){const o=new za(a);z[a]=o}if(t.match(/^openwb\/vehicle\/[0-9]+\/name$/i))Object.values(I).forEach(o=>{o.connectedVehicle==a&&(o.vehicleName=JSON.parse(e))}),z[a].name=JSON.parse(e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/get\/soc$/i))z[a].soc=JSON.parse(e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/get\/range$/i))z[a].range=+e;else if(t.match(/^openwb\/vehicle\/[0-9]+\/charge_template$/i))z[a].updateChargeTemplateId(+e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/ev_template$/i))z[a].updateEvTemplateId(+e);else if(t.match(/^openwb\/vehicle\/[0-9]+\/soc_module\/config$/i)){const o=JSON.parse(e);Object.values(I).forEach(n=>{n.connectedVehicle==a&&(n.isSocConfigured=o.type!==null,n.isSocManual=o.type=="manual")})}}}function _s(t,e){if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const o=+a[0],n=JSON.parse(e);ue[o]=n,ys(o,n)}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/time_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),o=t.match(/[0-9]+$/i);if(a&&o){const n=+a[0].replace(/[^0-9]+/g,""),i=+o[0],c=JSON.parse(e);n in Je||(Je[n]=[]),Je[n][i]=c}}else if(t.match(/^openwb\/vehicle\/template\/charge_template\/[0-9]+\/chargemode\/scheduled_charging\/plans\/[0-9]+$/i)){const a=t.match(/(?:\/)([0-9]+)(?:\/)/g),o=t.match(/[0-9]+$/i);if(a&&o){const n=+a[0].replace(/[^0-9]+/g,""),i=+o[0],c=JSON.parse(e);n in Fe||(Fe[n]=[]),Fe[n][i]=c}}else if(t.match(/^openwb\/vehicle\/template\/ev_template\/[0-9]+$/i)){const a=t.match(/[0-9]+$/i);if(a){const o=+a[0],n=JSON.parse(e);wt[o]=n}}}function ys(t,e){Object.values(I).forEach(a=>{a.chargeTemplate==t&&(a.updateCpPriority(e.prio),a.updateInstantChargeLimitMode(e.chargemode.instant_charging.limit.selected),a.updateInstantTargetCurrent(e.chargemode.instant_charging.current),a.updateInstantTargetSoc(e.chargemode.instant_charging.limit.soc),a.updateInstantMaxEnergy(e.chargemode.instant_charging.limit.amount),a.updatePvFeedInLimit(e.chargemode.pv_charging.feed_in_limit),a.updatePvMinCurrent(e.chargemode.pv_charging.min_current),a.updatePvMaxSoc(e.chargemode.pv_charging.max_soc),a.updatePvMinSoc(e.chargemode.pv_charging.min_soc),a.updatePvMinSocCurrent(e.chargemode.pv_charging.min_soc_current))})}function da(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}function bs(t,e){t.match(/^openWB\/LegacySmarthome\/config\//i)?ws(t,e):t.match(/^openWB\/LegacySmarthome\/Devices\//i)&&ks(t,e)}function ws(t,e){const a=ha(t);a!=null&&(a in W||Kt(a),t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_configured$/i)?W[a].configured=e!="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_name$/i)?(W[a].name=e.toString(),W[a].icon=e.toString(),ie["sh"+a].name=e.toString(),ie["sh"+a].icon=e.toString()):t.match(/^openWB\/LegacySmarthome\/config\/set\/Devices\/[0-9]+\/mode$/i)?W[a].isAutomatic=e=="0":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_canSwitch$/i)?W[a].canSwitch=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_homeConsumtion$/i)?W[a].countAsHouse=e=="1":t.match(/^openWB\/LegacySmarthome\/config\/get\/Devices\/[0-9]+\/device_temperatur_configured$/i)&&(W[a].tempConfigured=+e))}function ks(t,e){const a=ha(t);if(a==null){console.warn("Smarthome: Missing index in "+t);return}if(a in W||Kt(a),t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Watt$/i))W[a].power=+e,Ss("power");else if(!t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/Wh$/i)){if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/RunningTimeToday$/i))W[a].runningTime=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor0$/i))W[a].temp[0]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor1$/i))W[a].temp[1]=+e;else if(t.match(/^openWB\/LegacySmarthome\/Devices\/[0-9]+\/TemperatureSensor2$/i))W[a].temp[2]=+e;else if(t.match(/^openWB\/LegacySmartHome\/Devices\/[0-9]+\/Status$/i))switch(+e){case 10:W[a].status="off";break;case 11:W[a].status="on";break;case 20:W[a].status="detection";break;case 30:W[a].status="timeout";break;default:W[a].status="off"}}}function Ss(t){switch(t){case"power":C.devices.power=Object.values(W).filter(e=>e.configured&&!e.countAsHouse).reduce((e,a)=>e+a.power,0);break;case"energy":C.devices.energy=Object.values(W).filter(e=>e.configured&&!e.countAsHouse).reduce((e,a)=>e+a.energy,0);break;default:console.error("Unknown category")}}function ha(t){let e=0;try{const a=t.match(/(?:\/)([0-9]+)(?=\/)/g);return a?(e=+a[0].replace(/[^0-9]+/g,""),e):void 0}catch{console.warn("Parser error in getIndex for topic "+t)}}class xs{constructor(e){l(this,"id");l(this,"name","ZÃ¤hler");l(this,"power",0);l(this,"energy_imported",0);l(this,"energy_exported",0);l(this,"grid",!1);l(this,"type","counter");l(this,"color","var(--color-evu)");l(this,"energyPv",0);l(this,"energyBat",0);l(this,"pvPercentage",0);l(this,"icon","");this.id=e}}const ve=Y({});function Ms(t,e){if(t in ve)console.info("Duplicate counter message: "+t);else switch(ve[t]=new xs(t),ve[t].type=e,e){case"counter":ve[t].color="var(--color-evu)";break;case"inverter":ve[t].color="var(--color-pv)";break;case"cp":ve[t].color="var(--color-charging)";break;case"bat":ve[t].color="var(--color-bat)";break}}const $s=["openWB/counter/#","openWB/bat/#","openWB/pv/get/#","openWB/chargepoint/#","openWB/vehicle/#","openWB/general/chargemode_config/pv_charging/#","openWB/optional/et/#","openWB/system/#","openWB/LegacySmartHome/#","openWB/command/"+St()+"/#","openWB/optional/int_display/#"];function Ps(){Ea(Is),$s.forEach(t=>{Ae(t)}),re()}function Is(t,e){const a=e.toString();t.match(/^openwb\/counter\/[0-9]+\//i)?Cs(t,a):t.match(/^openwb\/counter\//i)?Bs(t,a):t.match(/^openwb\/bat\//i)?ps(t,a):t.match(/^openwb\/pv\//i)?Os(t,a):t.match(/^openwb\/chargepoint\//i)?fs(t,a):t.match(/^openwb\/vehicle\/template\//i)?_s(t,a):t.match(/^openwb\/vehicle\//i)?vs(t,a):t.match(/^openwb\/general\/chargemode_config\/pv_charging\//i)?Ts(t,a):t.match(/^openwb\/graph\//i)?Zr(t,a):t.match(/^openwb\/log\/daily\//i)?as(t,a):t.match(/^openwb\/log\/monthly\//i)?ss(t,a):t.match(/^openwb\/log\/yearly\//i)?is(t,a):t.match(/^openwb\/optional\/et\//i)?ms(t,a):t.match(/^openwb\/system\//i)?Vs(t,a):t.match(/^openwb\/LegacySmartHome\//i)?bs(t,a):t.match(/^openwb\/command\//i)?As(t,a):t.match(/^openwb\/optional\//i)&&Ds(t,a)}function Cs(t,e){const a=t.split("/"),o=+a[2];if(o==te.evuId?Ls(t,e):a[3]=="config",a[3]=="get"&&o in ve)switch(a[4]){case"power":ve[o].power=+e;break;case"config":break;case"fault_str":break;case"fault_state":break;case"power_factors":break;case"imported":break;case"exported":break;case"frequency":break;case"daily_imported":ve[o].energy_imported=+e;break;case"daily_exported":ve[o].energy_exported=+e;break}}function Bs(t,e){if(t.match(/^openwb\/counter\/get\/hierarchy$/i)){const a=JSON.parse(e);if(a.length){Na(),hs();for(const o of a)o.type=="counter"&&(te.evuId=o.id);pa(a[0])}}else t.match(/^openwb\/counter\/set\/home_consumption$/i)?(C.house.power=+e,Ra()):t.match(/^openwb\/counter\/set\/daily_yield_home_consumption$/i)&&(C.house.energy=+e)}function pa(t){switch(t.type){case"counter":Ms(t.id,t.type);break;case"cp":ja(t.id);break;case"bat":ds(t.id);break}t.children.forEach(e=>pa(e))}function Os(t,e){switch(t){case"openWB/pv/get/power":N.pv.power=-e;break;case"openWB/pv/get/daily_exported":N.pv.energy=+e;break}}function Ts(t,e){const a=t.split("/");if(a.length>0)switch(a[4]){case"bat_prio":te.updatePvBatteryPriority(e=="true");break}}function Ls(t,e){switch(t.split("/")[4]){case"power":+e>0?(N.evuIn.power=+e,C.evuOut.power=0):(N.evuIn.power=0,C.evuOut.power=-e);break;case"daily_imported":N.evuIn.energy=+e;break;case"daily_exported":C.evuOut.energy=+e;break}}function Vs(t,e){if(t.match(/^openWB\/system\/device\/[0-9]+\/component\/[0-9]+\/config$/i)){const a=JSON.parse(e);a.type=="counter"&&(ve[a.id].name=a.name)}else t.match(/^openWB\/system\/ip_address$/i)?te.ipAddress=JSON.parse(e):t.match(/^openWB\/system\/time$/i)?te.systemTime=JSON.parse(e):t.match(/^openWB\/system\/version$/i)?te.version=JSON.parse(e):t.match(/^openWB\/system\/current_commit$/i)?te.versionDetails=JSON.parse(e):t.match(/^openWB\/system\/current_branch$/i)&&(te.devBranch=JSON.parse(e))}function As(t,e){const a=t.split("/");if(t.match(/^openWB\/command\/[a-z]+\/error$/i)&&a[2]==St()){const o=JSON.parse(e);console.error(`Error message from openWB: 
Command: ${o.command}
Data: JSON.stringify(err.data)
Error:
 ${o.error}`)}}function Ds(t,e){if(t.match(/^openwb\/optional\/int_display\/active$/i))fe.active=JSON.parse(e);else if(t.match(/^openwb\/optional\/int_display\/only_local_charge_points$/i))fe.localCpOnly=JSON.parse(e);else if(t.match(/^openwb\/optional\/int_display\/theme$/i)){const a=JSON.parse(e);fe.usePin=a.configuration.lock_changes,fe.code=a.configuration.lock_changes_code}}const Gs={class:"d-flex flex-column align-items-center justify-content-start infoitem"},Es=B({__name:"InfoItem",props:{heading:{},small:{type:Boolean}},setup(t){const e=t,a=g(()=>e.small?{"font-size":"var(--font-small)"}:{"font-size":"var(--font-small)"}),o=g(()=>e.small?{"font-size":"var(--font-small)"}:{"font-size":"var(--font-normal)"}),n=g(()=>e.small?"mt-0":"mt-1");return(i,c)=>(u(),f("span",Gs,[s("span",{class:Z(["d-flex heading",n.value]),style:ee(a.value)},x(e.heading),7),s("span",{class:"d-flex my-0 me-0 align-items-center content",style:ee(o.value)},[de(i.$slots,"default",{},void 0,!0)],4)]))}}),he=F(Es,[["__scopeId","data-v-f6af00e8"]]),Ws={class:"d-flex justify-content-between align-items-center titlerow"},zs={class:"buttonarea grid-col-12",style:{"text-align":"right"}},js={class:"contentrow grid-col-12"},Ns=B({__name:"WbSubwidget",props:{titlecolor:{},fullwidth:{type:Boolean},small:{type:Boolean}},setup(t){const e=t,a=g(()=>{let n={"font-weight":"bold",color:"var(--color-fg)","font-size":"var(--font-normal)"};return e.titlecolor&&(n.color=e.titlecolor),e.small&&(n["font-size"]="var(--font-verysmall)"),n}),o=g(()=>e.fullwidth?"grid-col-12":"grid-col-4");return(n,i)=>(u(),f("div",{class:Z(["wb-subwidget px-3 pt-2 my-0",o.value])},[s("div",Ws,[s("div",{class:"d-flex widgetname p-0 m-0",style:ee(a.value)},[de(n.$slots,"title",{},void 0,!0)],4),s("div",zs,[de(n.$slots,"buttons",{},void 0,!0)])]),s("div",js,[de(n.$slots,"default",{},void 0,!0)])],2))}}),Us=F(Ns,[["__scopeId","data-v-971e553f"]]),Fs=t=>(le("data-v-b935eb33"),t=t(),ce(),t),Js={class:"grid-col-12 mt-2 mb-0 px-0 py-0 configitem"},Rs={class:"titlecolumn m-0 p-0 d-flex align-items-center"},Hs=Fs(()=>s("i",{class:"me-1 fa-solid fa-sm fa-circle-info"},null,-1)),Ys={class:"ms-1 mb-2 p-0 pt-2 d-flex justify-content-stretch align-items-center"},qs={class:"justify-content-stretch d-flex"},Qs=B({__name:"ConfigItem",props:{title:{},infotext:{},icon:{},fullwidth:{type:Boolean}},setup(t){const e=t,a=X(!1);function o(){a.value=!a.value}const n=g(()=>{let i={color:"var(--color-charging)"};return a.value&&(i.color="var(--color-battery)"),i});return(i,c)=>(u(),A(Us,{fullwidth:!!i.fullwidth},{default:S(()=>[s("div",Js,[s("div",Rs,[s("span",{class:"d-flex align-items-baseline m-0 p-0",onClick:o},[e.icon?(u(),f("i",{key:0,class:Z(["fa-solid fa-sm m-0 p-0 me-2 item-icon",e.icon])},null,2)):k("",!0),R(" "+x(i.title),1)]),s("span",null,[e.infotext?(u(),f("i",{key:0,class:"fa-solid fa-sm fa-circle-question ms-4 me-2",style:ee(n.value),onClick:o},null,4)):k("",!0)])]),a.value?(u(),f("p",{key:0,class:"infotext shadow m-0 ps-2 mb-1 p-1",onClick:o},[Hs,R(" "+x(i.infotext),1)])):k("",!0),s("div",Ys,[s("span",qs,[de(i.$slots,"default",{},void 0,!0)])])])]),_:3},8,["fullwidth"]))}}),Q=F(Qs,[["__scopeId","data-v-b935eb33"]]),ga=t=>(le("data-v-17a828b1"),t=t(),ce(),t),Zs={class:"d-flex flex-column"},Xs={class:"d-flex flex-fill justify-content-between align-items-center"},Ks=ga(()=>s("i",{class:"fa fa-xl fa-minus-square me-2"},null,-1)),ei=[Ks],ti=["id","min","max","step"],ai=ga(()=>s("i",{class:"fa fa-xl fa-plus-square ms-2"},null,-1)),oi=[ai],ni={class:"d-flex justify-content-between align-items-center"},ri={class:"minlabel ps-4"},si={class:"valuelabel"},ii={class:"maxlabel pe-4"},li=B({__name:"RangeInput",props:{id:{},min:{},max:{},step:{},unit:{},decimals:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=a.decimals??0,n=e,i=g({get(){return Math.round(a.modelValue*Math.pow(10,o))/Math.pow(10,o)},set(d){n("update:modelValue",d)}});function c(){i.value>a.min&&(i.value=Math.round((i.value-a.step)*Math.pow(10,o))/Math.pow(10,o))}function h(){i.value<a.max&&(i.value=Math.round((i.value+a.step)*Math.pow(10,o))/Math.pow(10,o))}return(d,m)=>(u(),f("span",Zs,[s("span",Xs,[s("span",{type:"button",class:"minusButton",onClick:c},ei),We(s("input",{id:d.id,"onUpdate:modelValue":m[0]||(m[0]=v=>i.value=v),type:"range",class:"form-range flex-fill",min:d.min,max:d.max,step:d.step},null,8,ti),[[Ca,i.value,void 0,{number:!0}]]),s("span",{type:"button",class:"plusButton",onClick:h},oi)]),s("span",ni,[s("span",ri,x(d.min),1),s("span",si,x(i.value)+" "+x(d.unit),1),s("span",ii,x(d.max),1)])]))}}),Oe=F(li,[["__scopeId","data-v-17a828b1"]]),ci=["id","value"],ui=B({__name:"RadioInput",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=e,n=g({get(){return a.modelValue},set(h){o("update:modelValue",h)}});function i(h){return a.options[h][2]?{color:a.options[h][2]}:{color:"var(--color-fg)"}}function c(h){let d=h.target;for(;d&&!d.value&&d.parentElement;)d=d.parentElement;d.value&&(n.value=d.value)}return(h,d)=>(u(),f("div",null,[(u(!0),f(K,null,ge(h.options,(m,v)=>(u(),f("button",{id:"radio-"+m[1],key:v,class:Z(["btn btn-outline-secondary radiobutton me-2 mb-0 px-2",m[1]==n.value?"active":""]),value:m[1],style:ee(i(v)),onClick:c},[s("span",{style:ee(i(v))},[m[3]?(u(),f("i",{key:0,class:Z(["fa-solid",m[3]])},null,2)):k("",!0),R(" "+x(m[0]),1)],4)],14,ci))),128))]))}}),Qe=F(ui,[["__scopeId","data-v-df222cbe"]]),di=t=>(le("data-v-0303d179"),t=t(),ce(),t),hi={class:"mt-2"},pi=di(()=>s("p",{class:"heading ms-1"},"Sofortladen:",-1)),gi={key:0},mi=B({__name:"CPConfigInstant",props:{chargepoint:{}},setup(t){const a=X(t.chargepoint),o=[{name:"keine",id:"none"},{name:"EV-SoC",id:"soc"},{name:"Energiemenge",id:"amount"}],n=g({get(){return a.value.instantMaxEnergy/1e3},set(i){a.value.instantMaxEnergy=i*1e3}});return(i,c)=>(u(),f("div",hi,[pi,w(Q,{title:"StromstÃ¤rke",icon:"fa-bolt",fullwidth:!0},{default:S(()=>[w(Oe,{id:"targetCurrent",modelValue:a.value.instantTargetCurrent,"onUpdate:modelValue":c[0]||(c[0]=h=>a.value.instantTargetCurrent=h),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1}),a.value.instantChargeLimitMode!="none"?(u(),f("hr",gi)):k("",!0),w(Q,{title:"Begrenzung",icon:"fa-hand",fullwidth:!0},{default:S(()=>[w(Qe,{modelValue:a.value.instantChargeLimitMode,"onUpdate:modelValue":c[1]||(c[1]=h=>a.value.instantChargeLimitMode=h),options:o.map(h=>[h.name,h.id])},null,8,["modelValue","options"])]),_:1}),a.value.instantChargeLimitMode=="soc"?(u(),A(Q,{key:1,title:"Maximaler SoC",icon:"fa-sliders",fullwidth:!0},{default:S(()=>[w(Oe,{id:"maxSoc",modelValue:a.value.instantTargetSoc,"onUpdate:modelValue":c[2]||(c[2]=h=>a.value.instantTargetSoc=h),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):k("",!0),a.value.instantChargeLimitMode=="amount"?(u(),A(Q,{key:2,title:"Zu ladende Energie",icon:"fa-sliders",fullwidth:!0},{default:S(()=>[w(Oe,{id:"maxEnergy",modelValue:n.value,"onUpdate:modelValue":c[3]||(c[3]=h=>n.value=h),min:0,max:100,step:1,unit:"kWh"},null,8,["modelValue"])]),_:1})):k("",!0)]))}}),fi=F(mi,[["__scopeId","data-v-0303d179"]]),vi={class:"form-check form-switch"},Ee=B({__name:"SwitchInput",props:{modelValue:{type:Boolean},onColor:{},offColor:{}},emits:["update:modelValue"],setup(t,{emit:e}){const a=t,o=e,n=g({get(){return a.modelValue},set(c){o("update:modelValue",c)}}),i=g(()=>n.value?{"background-color":"green"}:{"background-color":"white"});return(c,h)=>(u(),f("div",vi,[We(s("input",{"onUpdate:modelValue":h[0]||(h[0]=d=>n.value=d),class:"form-check-input",type:"checkbox",role:"switch",style:ee(i.value)},null,4),[[Jt,n.value]])]))}}),ma=t=>(le("data-v-1a90f282"),t=t(),ce(),t),_i={class:"pt-2"},yi=ma(()=>s("p",{class:"heading ms-1"},"PV-Laden:",-1)),bi={class:"form-check form-switch"},wi=ma(()=>s("hr",null,null,-1)),ki={key:2},Si=B({__name:"CPConfigPv",props:{chargepoint:{}},setup(t){const a=X(t.chargepoint),o=g({get(){return a.value.pvMinCurrent>5},set(i){i?a.value.pvMinCurrent=6:a.value.pvMinCurrent=0}}),n=g({get(){return a.value.pvMinSoc>0},set(i){i?a.value.pvMinSoc=50:a.value.pvMinSoc=0}});return(i,c)=>(u(),f("div",_i,[yi,w(Q,{title:"Maximaler Ladestand",icon:"fa-battery-three-quarters",fullwidth:!0},{default:S(()=>[w(Oe,{id:"maxSoc",modelValue:a.value.pvMaxSoc,"onUpdate:modelValue":c[0]||(c[0]=h=>a.value.pvMaxSoc=h),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1}),w(Q,{title:"Einspeisegrenze beachten",icon:"fa-hand",fullwidth:!0},{default:S(()=>[s("div",bi,[We(s("input",{id:"feedInLimitSwitch","onUpdate:modelValue":c[1]||(c[1]=h=>a.value.pvFeedInLimit=h),class:"form-check-input",type:"checkbox",role:"switch"},null,512),[[Jt,a.value.pvFeedInLimit]])])]),_:1}),wi,w(Q,{title:"Minimaler Ladestand",icon:"fa-battery-half",infotext:r(Pe).minsoc,fullwidth:!0},{default:S(()=>[w(Ee,{modelValue:n.value,"onUpdate:modelValue":c[2]||(c[2]=h=>n.value=h)},null,8,["modelValue"])]),_:1},8,["infotext"]),n.value?(u(),A(Q,{key:0,title:"...bis SoC",fullwidth:!0},{info:S(()=>[R(x(r(Pe).minsoc),1)]),default:S(()=>[w(Oe,{id:"minSoc",modelValue:a.value.pvMinSoc,"onUpdate:modelValue":c[3]||(c[3]=h=>a.value.pvMinSoc=h),min:0,max:100,step:1,unit:"%"},null,8,["modelValue"])]),_:1})):k("",!0),n.value?(u(),A(Q,{key:1,title:"...mit Ladestrom",fullwidth:!0},{default:S(()=>[w(Oe,{id:"minSocCurrent",modelValue:a.value.pvMinSocCurrent,"onUpdate:modelValue":c[4]||(c[4]=h=>a.value.pvMinSocCurrent=h),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):k("",!0),o.value||n.value?(u(),f("hr",ki)):k("",!0),w(Q,{title:"Minimaler Ladestrom",icon:"fa-bolt",infotext:r(Pe).minpv,fullwidth:!0},{default:S(()=>[w(Ee,{modelValue:o.value,"onUpdate:modelValue":c[5]||(c[5]=h=>o.value=h)},null,8,["modelValue"])]),_:1},8,["infotext"]),o.value?(u(),A(Q,{key:3,title:"...bei Ladestrom (minimal)",fullwidth:!0},{default:S(()=>[w(Oe,{id:"minCurrent",modelValue:a.value.pvMinCurrent,"onUpdate:modelValue":c[6]||(c[6]=h=>a.value.pvMinCurrent=h),min:6,max:32,step:1,unit:"A"},null,8,["modelValue"])]),_:1})):k("",!0)]))}}),xi=F(Si,[["__scopeId","data-v-1a90f282"]]),fa=t=>(le("data-v-e8f5ad9d"),t=t(),ce(),t),Mi=fa(()=>s("p",{class:"heading ms-1 pt-2"},"Zielladen:",-1)),$i={class:"table table-borderless"},Pi=fa(()=>s("thead",null,[s("tr",null,[s("th",{class:"tableheader"},"Ziel"),s("th",{class:"tableheader"},"Limit"),s("th",{class:"tableheader"},"Zeit"),s("th",{class:"tableheader"},"Wiederholung"),s("th",{class:"tableheader"})])],-1)),Ii={class:"tablecell"},Ci={class:"tablecell"},Bi={class:"tablecell"},Oi={class:"tablecell"},Ti={class:"tablecell left"},Li=["href"],Vi=B({__name:"CPConfigScheduled",props:{chargeTemplateId:{}},setup(t){const e={daily:"TÃ¤glich",once:"Einmal",weekly:"WÃ¶chentlich"},a=t,o=g(()=>{let h=[];return Fe[a.chargeTemplateId]&&(h=Object.values(Fe[a.chargeTemplateId])),h});function n(h){return o.value[h].time}function i(h){return{color:o.value[h].active?"var(--color-switchGreen)":"var(--color-switchRed)"}}function c(h){return{"font-weight":o.value[h].active?"bold":"regular"}}return(h,d)=>(u(),f(K,null,[Mi,s("table",$i,[Pi,s("tbody",null,[(u(!0),f(K,null,ge(o.value,(m,v)=>(u(),f("tr",{key:v,style:ee(c(v))},[s("td",Ii,x(m.limit.soc_scheduled)+"%",1),s("td",Ci,x(m.limit.soc_limit)+"%",1),s("td",Bi,x(n(v)),1),s("td",Oi,x(e[m.frequency.selected]),1),s("td",Ti,[s("a",{href:"../../settings/#/VehicleConfiguration/charge_template/"+a.chargeTemplateId},[s("span",{class:Z([m.active?"fa-toggle-on":"fa-toggle-off","fa"]),style:ee(i(v)),type:"button"},null,6)],8,Li)])],4))),128))])])],64))}}),Ai=F(Vi,[["__scopeId","data-v-e8f5ad9d"]]),va=t=>(le("data-v-192e287b"),t=t(),ce(),t),Di=va(()=>s("p",{class:"heading ms-1 pt-2"},"ZeitplÃ¤ne:",-1)),Gi={class:"table table-borderless"},Ei=va(()=>s("thead",null,[s("tr",null,[s("th",{class:"tableheader"},"Von"),s("th",{class:"tableheader"},"Bis"),s("th",{class:"tableheader"},"Ladestrom"),s("th",{class:"tableheader"},"Wiederholung"),s("th",{class:"tableheader right"})])],-1)),Wi={class:"tablecell"},zi={class:"tablecell"},ji={class:"tablecell"},Ni={class:"tablecell"},Ui={class:"tablecell left"},Fi=["href"],Ji=B({__name:"CPConfigTimed",props:{chargeTemplateId:{}},setup(t){const e={daily:"TÃ¤glich",once:"Einmal",weekly:"WÃ¶chentlich"},a=t,o=g(()=>Je[a.chargeTemplateId]?Object.values(Je[a.chargeTemplateId])??[]:[]);function n(c){return{color:o.value[c].active?"var(--color-switchGreen)":"var(--color-switchRed)"}}function i(c){return{"font-weight":o.value[c].active?"bold":"regular"}}return(c,h)=>(u(),f(K,null,[Di,s("table",Gi,[Ei,s("tbody",null,[(u(!0),f(K,null,ge(o.value,(d,m)=>(u(),f("tr",{key:m,style:ee(i(m))},[s("td",Wi,x(d.time[0]),1),s("td",zi,x(d.time[1]),1),s("td",ji,x(d.current)+" A",1),s("td",Ni,x(e[d.frequency.selected]),1),s("td",Ui,[s("a",{href:"../../settings/#/VehicleConfiguration/charge_template/"+a.chargeTemplateId},[s("span",{class:Z([d.active?"fa-toggle-on":"fa-toggle-off","fa"]),style:ee(n(m)),type:"button"},null,6)],8,Fi)])],4))),128))])])],64))}}),Ri=F(Ji,[["__scopeId","data-v-192e287b"]]),Hi={class:"settingsheader mt-2 ms-1"},Yi=B({__name:"CPConfigVehicle",props:{vehicleId:{}},setup(t){const e=t;return(a,o)=>(u(),f(K,null,[s("p",Hi," Profile fÃ¼r "+x(r(z)[e.vehicleId].name)+": ",1),w(Q,{title:"Ladeprofil",icon:"fa-sliders",fullwidth:!0},{default:S(()=>[w(Qe,{modelValue:r(z)[e.vehicleId].chargeTemplateId,"onUpdate:modelValue":o[0]||(o[0]=n=>r(z)[e.vehicleId].chargeTemplateId=n),modelModifiers:{number:!0},options:Object.keys(r(ue)).map(n=>[r(ue)[+n].name,n])},null,8,["modelValue","options"])]),_:1}),w(Q,{title:"Fahrzeug-Vorlage",icon:"fa-sliders",fullwidth:!0},{default:S(()=>[w(Qe,{modelValue:r(z)[e.vehicleId].evTemplateId,"onUpdate:modelValue":o[1]||(o[1]=n=>r(z)[e.vehicleId].evTemplateId=n),modelModifiers:{number:!0},options:Object.keys(r(wt)).map(n=>[r(wt)[+n].name,n])},null,8,["modelValue","options"])]),_:1})],64))}}),qi=F(Yi,[["__scopeId","data-v-fcb57a44"]]),Qi={class:"settingsheader mt-2 ms-1"},Zi=B({__name:"CPChargeConfig",props:{chargepoint:{}},emits:["closeConfig"],setup(t){const a=t.chargepoint;return(o,n)=>(u(),f(K,null,[s("p",Qi," Ladeeinstellungen fÃ¼r "+x(r(a).vehicleName)+": ",1),w(Q,{title:"Lademodus",icon:"fa-charging-station",infotext:r(Pe).chargemode,fullwidth:!0},{default:S(()=>[w(Qe,{modelValue:r(a).chargeMode,"onUpdate:modelValue":n[0]||(n[0]=i=>r(a).chargeMode=i),options:Object.keys(r(Ce)).map(i=>[r(Ce)[i].name,i,r(Ce)[i].color,r(Ce)[i].icon])},null,8,["modelValue","options"])]),_:1},8,["infotext"]),w(Q,{title:"Fahrzeug wechseln",icon:"fa-car",infotext:r(Pe).vehicle,fullwidth:!0},{default:S(()=>[w(Qe,{modelValue:r(a).connectedVehicle,"onUpdate:modelValue":n[1]||(n[1]=i=>r(a).connectedVehicle=i),modelModifiers:{number:!0},options:Object.values(r(z)).map(i=>[i.name,i.id])},null,8,["modelValue","options"])]),_:1},8,["infotext"]),w(Q,{title:"Sperren",icon:"fa-lock",infotext:r(Pe).locked,fullwidth:!0},{default:S(()=>[w(Ee,{modelValue:r(a).isLocked,"onUpdate:modelValue":n[2]||(n[2]=i=>r(a).isLocked=i)},null,8,["modelValue"])]),_:1},8,["infotext"]),w(Q,{title:"PrioritÃ¤t",icon:"fa-star",infotext:r(Pe).priority,fullwidth:!0},{default:S(()=>[w(Ee,{modelValue:r(a).hasPriority,"onUpdate:modelValue":n[3]||(n[3]=i=>r(a).hasPriority=i)},null,8,["modelValue"])]),_:1},8,["infotext"]),w(Q,{title:"Zeitplan",icon:"fa-clock",infotext:r(Pe).timeplan,fullwidth:!0},{default:S(()=>[w(Ee,{modelValue:r(a).timedCharging,"onUpdate:modelValue":n[4]||(n[4]=i=>r(a).timedCharging=i)},null,8,["modelValue"])]),_:1},8,["infotext"]),r(ne).active?(u(),A(Q,{key:0,title:"Strompreisbasiert laden",icon:"fa-money-bill",infotext:r(Pe).pricebased,fullwidth:!0},{default:S(()=>[w(Ee,{modelValue:r(a).etActive,"onUpdate:modelValue":n[5]||(n[5]=i=>r(a).etActive=i)},null,8,["modelValue"])]),_:1},8,["infotext"])):k("",!0)],64))}}),Xi=F(Zi,[["__scopeId","data-v-a64493d7"]]),_a=t=>(le("data-v-5286b19d"),t=t(),ce(),t),Ki=_a(()=>s("p",{class:"settingsheader mt-2 ms-1"},"Preisbasiertes Laden:",-1)),el={class:"providername ms-1"},tl=_a(()=>s("hr",null,null,-1)),al={class:"container"},ol={id:"pricechart",class:"p-0 m-0"},nl={viewBox:"0 0 400 300"},rl=["id","origin","transform"],sl={key:0,class:"p-3"},il={key:1,class:"d-flex justify-content-end"},ll=["disabled"],Ne=400,zt=250,jt=12,cl=B({__name:"PriceChart",props:{chargepoint:{},globalview:{type:Boolean}},setup(t){const e=t;let a=e.chargepoint?X(e.chargepoint.etMaxPrice):X(0);const o=X(!1),n=X(e.chargepoint),i=g({get(){return a.value},set(y){a.value=y,o.value=!0}});function c(){n.value&&(I[n.value.id].etMaxPrice=i.value),o.value=!1}const h=X(!1),d={top:0,bottom:15,left:20,right:5},m=g(()=>{let y=[];return ne.etPriceList.size>0&&ne.etPriceList.forEach((L,D)=>{y.push([D,L])}),y}),v=g(()=>m.value.length>1?(Ne-d.left-d.right)/m.value.length-1:0),O=g(()=>o.value?{background:"var(--color-charging)"}:{background:"var(--color-menu)"}),$=g(()=>{let y=De(m.value,L=>L[0]);return Ye().range([d.left,Ne-d.left-d.right]).domain(y)}),U=g(()=>{let y=De(m.value,L=>L[1]);return y[0]=Math.floor(y[0]-1),y[1]=Math.floor(y[1]+1),y}),J=g(()=>Te().range([zt-d.bottom,0]).domain(U.value)),V=g(()=>{const y=yt(),L=[[d.left,J.value(i.value)],[Ne-d.right,J.value(i.value)]];return y(L)}),T=g(()=>{const y=yt(),L=[[d.left,J.value(0)],[Ne-d.right,J.value(0)]];return y(L)}),E=g(()=>at($.value).ticks(6).tickSize(5).tickFormat(_t("%H:%M"))),j=g(()=>ut(J.value).ticks(6).tickSizeInner(-(Ne-d.right-d.left)).tickFormat(y=>y.toString())),M=g(()=>{h.value==!0;const y=ye("g#"+b.value);y.selectAll("*").remove(),y.selectAll("bar").data(m.value).enter().append("g").append("rect").attr("class","bar").attr("x",Le=>$.value(Le[0])).attr("y",Le=>J.value(Le[1])).attr("width",v.value).attr("height",Le=>J.value(U.value[0])-J.value(Le[1])).attr("fill",Le=>Le[1]<=i.value?"var(--color-charging)":"var(--color-axis)");const D=y.append("g").attr("class","axis").call(E.value);D.attr("transform","translate(0,"+(zt-d.bottom)+")"),D.selectAll(".tick").attr("font-size",jt).attr("color","var(--color-bg)"),D.selectAll(".tick line").attr("stroke","var(--color-fg)").attr("stroke-width","0.5"),D.select(".domain").attr("stroke","var(--color-bg");const se=y.append("g").attr("class","axis").call(j.value);return se.attr("transform","translate("+d.left+",0)"),se.selectAll(".tick").attr("font-size",jt).attr("color","var(--color-bg)"),se.selectAll(".tick line").attr("stroke","var(--color-bg)").attr("stroke-width","0.5"),se.select(".domain").attr("stroke","var(--color-bg)"),U.value[0]<0&&y.append("path").attr("d",T.value).attr("stroke","var(--color-fg)"),y.append("path").attr("d",V.value).attr("stroke","yellow"),"PriceChart.vue"}),b=g(()=>e.chargepoint?"priceChartCanvas"+e.chargepoint.id:"priceChartCanvasGlobal");return je(()=>{h.value=!h.value}),(y,L)=>(u(),f(K,null,[Ki,s("p",el,"Anbieter: "+x(r(ne).etProvider),1),tl,s("div",al,[s("figure",ol,[(u(),f("svg",nl,[s("g",{id:b.value,origin:M.value,transform:"translate("+d.top+","+d.right+")"},null,8,rl)]))])]),y.chargepoint!=null?(u(),f("div",sl,[y.chargepoint.etActive?(u(),A(Oe,{key:0,id:"foo",modelValue:i.value,"onUpdate:modelValue":L[0]||(L[0]=D=>i.value=D),min:-25,max:95,step:.1,decimals:1,unit:"ct"},null,8,["modelValue"])):k("",!0)])):k("",!0),y.chargepoint!=null?(u(),f("div",il,[s("span",{class:"me-3 pt-0",onClick:c},[s("button",{type:"button",class:"btn btn-secondary",style:ee(O.value),disabled:!o.value}," BestÃ¤tigen ",12,ll)])])):k("",!0)],64))}}),ul=F(cl,[["__scopeId","data-v-5286b19d"]]),Ge=t=>(le("data-v-fdc511bd"),t=t(),ce(),t),dl={class:"status-string"},hl={style:{color:"red"}},pl={class:"m-0 mt-4 p-0 grid-col-12 tabarea"},gl={class:"nav nav-tabs nav-justified mx-1 mt-1",role:"tablist"},ml=["data-bs-target"],fl=Ge(()=>s("i",{class:"fa-solid fa-charging-station"},null,-1)),vl=[fl],_l=["data-bs-target"],yl=Ge(()=>s("i",{class:"fa-solid fa-lg fa-bolt"},null,-1)),bl=[yl],wl=["data-bs-target"],kl=Ge(()=>s("i",{class:"fa-solid fa-solar-panel me-1"},null,-1)),Sl=[kl],xl=["data-bs-target"],Ml=Ge(()=>s("i",{class:"fa-solid fa-bullseye me-1"},null,-1)),$l=[Ml],Pl=["data-bs-target"],Il=Ge(()=>s("i",{class:"fa-solid fa-clock"},null,-1)),Cl=[Il],Bl=["data-bs-target"],Ol=Ge(()=>s("i",{class:"fa-solid fa-rectangle-list"},null,-1)),Tl=[Ol],Ll=["data-bs-target"],Vl=Ge(()=>s("i",{class:"fa-solid fa-chart-line"},null,-1)),Al=[Vl],Dl={id:"settingsPanes",class:"tab-content mx-1 p-1 pb-3"},Gl=["id"],El=["id"],Wl=["id"],zl=["id"],jl=["id"],Nl=["id"],Ul=["id"],Fl=B({__name:"CPChargeConfigPanel",props:{chargepoint:{}},emits:["closeConfig"],setup(t){const a=t.chargepoint,o=g(()=>ue[a.chargeTemplate]),n=g(()=>a.id);return je(()=>{}),(i,c)=>(u(),f(K,null,[w(Q,{title:"Status",icon:"fa-info-circle",fullwidth:!0,class:"item"},{default:S(()=>[s("span",dl,x(r(a).stateStr),1)]),_:1}),r(a).faultState!=0?(u(),A(Q,{key:0,title:"Fehler",class:"grid-col-12"},{default:S(()=>[s("span",hl,x(r(a).faultStr),1)]),_:1})):k("",!0),s("div",pl,[s("nav",gl,[s("a",{class:"nav-link active","data-bs-toggle":"tab","data-bs-target":"#chargeSettings"+n.value},vl,8,ml),i.chargepoint.chargeMode=="instant_charging"?(u(),f("a",{key:0,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#instantSettings"+n.value},bl,8,_l)):k("",!0),i.chargepoint.chargeMode=="pv_charging"?(u(),f("a",{key:1,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#pvSettings"+n.value},Sl,8,wl)):k("",!0),i.chargepoint.chargeMode=="scheduled_charging"?(u(),f("a",{key:2,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#scheduledSettings"+n.value},$l,8,xl)):k("",!0),i.chargepoint.timedCharging?(u(),f("a",{key:3,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#timeSettings"+n.value},Cl,8,Pl)):k("",!0),s("a",{class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#carSettings"+n.value},Tl,8,Bl),r(ne).active&&r(a).etActive?(u(),f("a",{key:4,class:"nav-link","data-bs-toggle":"tab","data-bs-target":"#priceChart"+n.value},Al,8,Ll)):k("",!0)]),s("div",Dl,[s("div",{id:"chargeSettings"+n.value,class:"tab-pane active",role:"tabpanel","aria-labelledby":"instant-tab"},[w(Xi,{chargepoint:i.chargepoint},null,8,["chargepoint"])],8,Gl),s("div",{id:"instantSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"instant-tab"},[w(fi,{chargepoint:r(a),vehicles:r(z),"charge-templates":r(ue)},null,8,["chargepoint","vehicles","charge-templates"])],8,El),s("div",{id:"pvSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"pv-tab"},[w(xi,{chargepoint:r(a),vehicles:r(z),"charge-templates":r(ue)},null,8,["chargepoint","vehicles","charge-templates"])],8,Wl),s("div",{id:"scheduledSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"scheduled-tab"},[o.value!=null?(u(),A(Ai,{key:0,"charge-template-id":r(a).chargeTemplate},null,8,["charge-template-id"])):k("",!0)],8,zl),s("div",{id:"timeSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"time-tab"},[o.value!=null?(u(),A(Ri,{key:0,"charge-template-id":r(a).chargeTemplate},null,8,["charge-template-id"])):k("",!0)],8,jl),s("div",{id:"carSettings"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"car-tab"},[r(z)[r(a).connectedVehicle]!=null?(u(),A(qi,{key:0,"vehicle-id":r(a).connectedVehicle},null,8,["vehicle-id"])):k("",!0)],8,Nl),s("div",{id:"priceChart"+n.value,class:"tab-pane",role:"tabpanel","aria-labelledby":"price-tab"},[r(z)[r(a).connectedVehicle]!=null?(u(),A(ul,{key:0,chargepoint:r(a)},null,8,["chargepoint"])):k("",!0)],8,Ul)])])],64))}}),Jl=F(Fl,[["__scopeId","data-v-fdc511bd"]]),Rl=B({__name:"BatterySymbol",props:{soc:{}},setup(t){const e=t,a=g(()=>e.soc<=10?"fa-battery-empty":e.soc<50?"fa-battery-quarter":e.soc<75?"fa-battery-half":e.soc<95?"fa-battery-three-quarters":"fa-battery-full");return(o,n)=>(u(),f("span",null,[s("i",{class:Z(["fa batIcon",a.value])},null,2),R(" "+x(Math.round(o.soc)+"%"),1)]))}}),Hl=F(Rl,[["__scopeId","data-v-a0bd055c"]]),Yl=B({__name:"FormatWattH",props:{wattH:{}},setup(t){const e=t,a=g(()=>Rt(e.wattH,_.decimalPlaces));return(o,n)=>(u(),f("span",null,x(a.value),1))}}),ya=t=>(le("data-v-00ab6a77"),t=t(),ce(),t),ql=ya(()=>s("span",{class:"fa-solid fa-charging-station"},"Â ",-1)),Ql={key:0},Zl={class:"grid12"},Xl={class:"targetCurrent"},Kl={key:1,class:"row m-0 mt-0 p-0"},ec={class:"col m-0 p-0"},tc={key:0},ac={class:"row"},oc={class:"col"},nc={class:"d-flex justify-content-between align-items-center"},rc=ya(()=>s("i",{class:"fa-solid fa-sm fa-car me-2"},null,-1)),sc={key:0,class:"me-1 fa-solid fa-xs fa-star ps-1"},ic={key:1,class:"me-0 fa-solid fa-xs fa-coins ps-0"},lc={class:"grid12"},cc={key:0,class:"me-1 fa-solid fa-xs fa-clock ps-1"},uc={type:"button"},dc=B({__name:"CPChargePoint",props:{chargepoint:{}},setup(t){const e=t,a=X(e.chargepoint),o=g({get(){return e.chargepoint.chargeMode},set(V){fe.locked?Xt():I[e.chargepoint.id].chargeMode=V}}),n=g(()=>(Math.round(e.chargepoint.current*10)/10).toLocaleString(void 0)+" A"),i=g(()=>(Math.round(e.chargepoint.realCurrent*10)/10).toLocaleString(void 0)+" A"),c=g(()=>Math.round(e.chargepoint.rangeCharged).toString()+" "+e.chargepoint.rangeUnit),h=g(()=>e.chargepoint.isLocked?"Gesperrt":e.chargepoint.isCharging?"LÃ¤dt":e.chargepoint.isPluggedIn?"Bereit":"Frei"),d=g(()=>e.chargepoint.isLocked?"var(--color-evu)":e.chargepoint.isCharging?"var(--color-charging)":e.chargepoint.isPluggedIn?"var(--color-battery)":"var(--color-axis)"),m=g(()=>{let V="";return e.chargepoint.isLocked?V="fa-lock":e.chargepoint.isCharging?V=" fa-bolt":e.chargepoint.isPluggedIn&&(V="fa-plug"),"fa "+V}),v=g(()=>e.chargepoint.soc),O=g(()=>({color:e.chargepoint.color})),$=g(()=>e.chargepoint.etMaxPrice>=+J.value?{color:"var(--color-charging)"}:{color:"var(--color-menu)"}),U=X(!1),J=g(()=>{const[V]=ne.etPriceList.values();return(Math.round(V*10)/10).toFixed(1)});return(V,T)=>U.value?k("",!0):(u(),A(dt,{key:0,"variable-width":!0},{title:S(()=>[s("span",{style:ee(O.value)},[ql,R(" "+x(e.chargepoint.name),1)],4)]),buttons:S(()=>[]),footer:S(()=>[U.value?k("",!0):(u(),f("div",tc,[s("div",ac,[s("div",oc,[s("div",nc,[s("h3",null,[rc,R(" "+x(V.chargepoint.vehicleName)+" ",1),V.chargepoint.hasPriority?(u(),f("span",sc)):k("",!0),V.chargepoint.etActive?(u(),f("span",ic)):k("",!0)])])])]),s("div",lc,[V.chargepoint.isSocConfigured?(u(),A(he,{key:0,heading:"Ladestand:",class:"grid-col-4 grid-left"},{default:S(()=>[w(Hl,{soc:v.value,class:"me-2"},null,8,["soc"])]),_:1})):k("",!0),V.chargepoint.isSocConfigured?(u(),A(he,{key:1,heading:"Reichweite:",class:"grid-col-4"},{default:S(()=>[R(x(r(z)[e.chargepoint.connectedVehicle]?Math.round(r(z)[e.chargepoint.connectedVehicle].range):0)+" km ",1)]),_:1})):k("",!0),w(he,{heading:"Zeitplan:",class:"grid-col-4 grid-right"},{default:S(()=>[V.chargepoint.timedCharging?(u(),f("span",cc)):k("",!0),R(" "+x(e.chargepoint.timedCharging?"Ja":"Nein"),1)]),_:1}),r(ne).active?(u(),A(he,{key:2,heading:"Preisladen:",class:"grid-col-4 grid-left"},{default:S(()=>[R(x(a.value.etActive?"Ja":"Nein"),1)]),_:1})):k("",!0),r(ne).active?(u(),A(he,{key:3,heading:"max. Preis:",class:"grid-col-4"},{default:S(()=>[s("span",uc,x(e.chargepoint.etActive?(Math.round(e.chargepoint.etMaxPrice*10)/10).toFixed(1)+" ct":"-"),1)]),_:1})):k("",!0),r(ne).active?(u(),A(he,{key:4,heading:"akt. Preis:",class:"grid-col-4 grid-right"},{default:S(()=>[s("span",{style:ee($.value)},x(J.value)+" ct ",5)]),_:1})):k("",!0),w(na,{id:"chargemode-"+V.chargepoint.name,modelValue:o.value,"onUpdate:modelValue":T[0]||(T[0]=E=>o.value=E),class:"chargemodes mt-3 mb-3",options:Object.keys(r(Ce)).map(E=>({text:r(Ce)[E].name,value:E,color:r(Ce)[E].color,icon:r(Ce)[E].icon,active:r(Ce)[E].mode==V.chargepoint.chargeMode}))},null,8,["id","modelValue","options"])])]))]),default:S(()=>[U.value?k("",!0):(u(),f("div",Ql,[s("div",Zl,[w(he,{heading:"Status:",class:"grid-col-4 grid-left"},{default:S(()=>[s("span",{style:ee({color:d.value})},[s("i",{class:Z(m.value)},null,2),R(" "+x(h.value),1)],4)]),_:1}),w(he,{heading:"Geladen:",class:"grid-col-4"},{default:S(()=>[w(Yl,{"watt-h":V.chargepoint.dailyYield},null,8,["watt-h"])]),_:1}),w(he,{heading:"gel. Reichw.:",class:"grid-col-4 grid-right"},{default:S(()=>[R(x(c.value),1)]),_:1}),e.chargepoint.power>0?(u(),A(he,{key:0,heading:"Leistung:",class:"grid-col-3 grid-left"},{default:S(()=>[w(ea,{watt:e.chargepoint.power},null,8,["watt"])]),_:1})):k("",!0),e.chargepoint.power>0?(u(),A(he,{key:1,heading:"Strom:",class:"grid-col-3"},{default:S(()=>[R(x(i.value),1)]),_:1})):k("",!0),e.chargepoint.power>0?(u(),A(he,{key:2,heading:"Phasen:",class:"grid-col-3"},{default:S(()=>[R(x(e.chargepoint.phasesInUse),1)]),_:1})):k("",!0),e.chargepoint.power>0?(u(),A(he,{key:3,heading:"Sollstrom:",class:"grid-col-3 grid-right"},{default:S(()=>[s("span",Xl,x(n.value),1)]),_:1})):k("",!0)])])),U.value?(u(),f("div",Kl,[s("div",ec,[V.chargepoint!=null?(u(),A(Jl,{key:0,chargepoint:V.chargepoint},null,8,["chargepoint"])):k("",!0)])])):k("",!0)]),_:1}))}}),hc=F(dc,[["__scopeId","data-v-00ab6a77"]]),pc={class:"content"},gc={class:"leftside"},mc={class:"rightside"},fc=B({__name:"DisplayTheme",setup(t){function e(o){Ja(o)&&(fe.locked=!1,setTimeout(()=>{fe.locked=!0},fe.timeout*1e3))}je(()=>{window.addEventListener("resize",Za),window.addEventListener("focus",a),Ps()});function a(){document.hasFocus()&&re()}return(o,n)=>(u(),f(K,null,[s("div",pc,[s("div",gc,[Object.values(r(I)).length>r(_).cpToShow?(u(),A(hc,{key:0,chargepoint:Object.values(r(I))[r(_).cpToShow],"full-width":!0},null,8,["chargepoint"])):k("",!0)]),s("div",mc,[We(s("div",null,[w(Wo)],512),[[pt,r(_).graphToShow=="powermeter"]]),We(s("div",null,[w(er)],512),[[pt,r(_).graphToShow=="powergraph"]]),We(s("div",null,[w(xr)],512),[[pt,r(_).graphToShow=="energymeter"]])])]),w(Wt,{"modal-id":"numberpad"},{title:S(()=>[R("PIN Eingeben")]),default:S(()=>[w(Nr,{"model-value":"","onUpdate:modelValue":e})]),_:1}),w(Wt,{"modal-id":"statuspage"},{title:S(()=>[R("Systemstatus")]),default:S(()=>[w(Qr)]),_:1})],64))}}),vc=F(fc,[["__scopeId","data-v-eef94f58"]]),_c={class:"fixeddisplay"},yc=B({__name:"App",setup(t){return(e,a)=>(u(),f("div",_c,[w(vc),w(co)]))}}),bc=F(yc,[["__scopeId","data-v-75d14554"]]),wc=Ba(bc);wc.mount("#app");
